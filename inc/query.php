<?php
DEFINE ("QRY_MAIN_NOTICE_COUNT",1);
DEFINE ("QRY_MAIN_NOTICE_LIST",2);
DEFINE ("QRY_USER_LIST_COUNT",3);
DEFINE ("QRY_USER_LIST",4);
DEFINE ("QRY_USER_LIST_EXCEL",5);
DEFINE ("QRY_MY_INFO",6);
DEFINE ("QRY_MY_INFO_UPDATE",7);
DEFINE ("QRY_USER_INFO",8);
DEFINE ("QRY_POLICY",9);
DEFINE ("QRY_POLICY_INSERT",10);
DEFINE ("QRY_SYSTEM",11);
DEFINE ("QRY_COM_VER_UPDATE",12);
DEFINE ("QRY_USER_LOGIN",13);
DEFINE ("QRY_USER_LOGIN_LOG",14);
DEFINE ("QRY_USER_PW_CHANGE_INFO",15);
DEFINE ("QRY_USER_PW_CHANGE",16);
DEFINE ("QRY_EMP_LIST_COUNT",17);
DEFINE ("QRY_EMP_LIST",18);
DEFINE ("QRY_EMP_LIST_EXCEL",19);
DEFINE ("QRY_EMP_INFO",20);
DEFINE ("QRY_EMP_INFO_PREV",21);
DEFINE ("QRY_EMP_INFO_NEXT",22);
DEFINE ("QRY_EMP_INSERT",23);
DEFINE ("QRY_ADMIN_MENU_INSERT",24);
DEFINE ("QRY_EMP_UPDATE",25);
DEFINE ("QRY_ADMIN_MENU_DELETE",26);
DEFINE ("QRY_EMP_DELETE",27);
DEFINE ("QRY_APP_UPDATE_LIST_COUNT",28);
DEFINE ("QRY_APP_UPDATE_LIST",29);
DEFINE ("QRY_APP_UPDATE_INFO",30);
DEFINE ("QRY_APP_UPDATE_INFO_PREV",31);
DEFINE ("QRY_APP_UPDATE_INFO_NEXT",32);
DEFINE ("QRY_APP_UPDATE_FILE",33);
DEFINE ("QRY_APP_UPDATE_INSERT",34);
DEFINE ("QRY_APP_UPDATE_UPDATE",35);
DEFINE ("QRY_APP_UPDATE_DELETE",36);
DEFINE ("QRY_CODE_LIST",37);
DEFINE ("QRY_CODE_INFO_CATE",38);
DEFINE ("QRY_CODE_INFO",39);
DEFINE ("QRY_CODE_INFO_PREV",40);
DEFINE ("QRY_CODE_INFO_NEXT",41);
DEFINE ("QRY_CODE_CATE_LIST",42);
DEFINE ("QRY_CODE_INSERT",43);
DEFINE ("QRY_CODE_UPDATE",44);
DEFINE ("QRY_CODE_DELETE",45);
DEFINE ("QRY_CODE_SUBCODE_COUNT",46);
DEFINE ("QRY_DEPT_LIST_COUNT",47);
DEFINE ("QRY_DEPT_LIST",48);
DEFINE ("QRY_DEPT_INFO",49);
DEFINE ("QRY_DEPT_INFO_PREV",50);
DEFINE ("QRY_DEPT_INFO_NEXT",51);
DEFINE ("QRY_DEPT_PARENT_INSERT",52);
DEFINE ("QRY_DEPT_INSERT",53);
DEFINE ("QRY_DEPT_UPDATE",54);
DEFINE ("QRY_DEPT_SUB_COUNT",55);
DEFINE ("QRY_DEPT_EMP_COUNT",56);
DEFINE ("QRY_DEPT_DELETE",57);
DEFINE ("QRY_TREE_ORGAN_LIST",58);
DEFINE ("QRY_TREE_DEPT_LIST",59);
DEFINE ("QRY_TREE_EMP_LIST",60);
DEFINE ("QRY_TREE_ORGAN_INFO",61);
DEFINE ("QRY_TREE_DEPT_INFO",62);
DEFINE ("QRY_TREE_USER_INFO",63);
DEFINE ("QRY_TREE_ORG_INSERT",64);
DEFINE ("QRY_TREE_ORG_UPDATE",65);
DEFINE ("QRY_TREE_ORG_DELETE",66);
DEFINE ("QRY_TREE_ORG_EMP_COUNT",67);
DEFINE ("QRY_TREE_ORG_DEPT_COUNT",68);
DEFINE ("QRY_TREE_ORG_COUNT",69);
DEFINE ("QRY_USER_PCID",70);
DEFINE ("QRY_GROUP_LIST_COUNT",71);
DEFINE ("QRY_GROUP_LIST",72);
DEFINE ("QRY_GROUP_INFO",73);
DEFINE ("QRY_GROUP_INFO_PREV",74);
DEFINE ("QRY_GROUP_INFO_NEXT",75);
DEFINE ("QRY_GROUP_INFO_ORG",76);
DEFINE ("QRY_GROUP_INSERT",77);
DEFINE ("QRY_GROUP_UPDATE",78);
DEFINE ("QRY_GROUP_DELETE",79);
DEFINE ("QRY_IP_LIST_COUNT",80);
DEFINE ("QRY_IP_LIST",81);
DEFINE ("QRY_IP_INFO",82);
DEFINE ("QRY_IP_INFO_PREV",83);
DEFINE ("QRY_IP_INFO_NEXT",84);
DEFINE ("QRY_IP_INSERT",85);
DEFINE ("QRY_IP_UPDATE",86);
DEFINE ("QRY_IP_DELETE",87);
DEFINE ("QRY_JOBPOS_LIST",88);
DEFINE ("QRY_JOBDUTY_LIST",89);
DEFINE ("QRY_JOBGRADE_LIST",90);
DEFINE ("QRY_JOBCODE_INFO",91);
DEFINE ("QRY_JOBCODE_INFO_PREV",92);
DEFINE ("QRY_JOBCODE_INFO_NEXT",93);
DEFINE ("QRY_JOBPOS_INSERT",94);
DEFINE ("QRY_JOBDUTY_INSERT",95);
DEFINE ("QRY_JOBGRADE_INSERT",96);
DEFINE ("QRY_JOBPOS_UPDATE",97);
DEFINE ("QRY_JOBDUTY_UPDATE",98);
DEFINE ("QRY_JOBGRADE_UPDATE",99);
DEFINE ("QRY_JOBPOS_DELETE",100);
DEFINE ("QRY_JOBDUTY_DELETE",101);
DEFINE ("QRY_JOBGRADE_DELETE",102);

DEFINE ("QRY_USER_LOGINLOG_LIST_COUNT",111);
DEFINE ("QRY_USER_LOGINLOG_LIST",112);
DEFINE ("QRY_USER_LOGINLOG_EXCEL",113);
DEFINE ("QRY_NOTICE_LIST_COUNT",114);
DEFINE ("QRY_NOTICE_LIST",115);
DEFINE ("QRY_NOTICE_INFO",116);
DEFINE ("QRY_NOTICE_INFO_PREV",117);
DEFINE ("QRY_NOTICE_INFO_NEXT",118);
DEFINE ("QRY_NOTICE_FILE",119);
DEFINE ("QRY_NOTICE_INSERT",120);
DEFINE ("QRY_NOTICE_UPDATE",121);
DEFINE ("QRY_NOTICE_DELETE",122);
DEFINE ("QRY_VACCINE_LIST_COUNT",123);
DEFINE ("QRY_VACCINE_LIST",124);
DEFINE ("QRY_VACCINE_INFO",125);
DEFINE ("QRY_VACCINE_INFO_PREV",126);
DEFINE ("QRY_VACCINE_INFO_NEXT",127);
DEFINE ("QRY_VACCINE_INSERT",128);
DEFINE ("QRY_VACCINE_UPDATE",129);
DEFINE ("QRY_VACCINE_DELETE",130);
DEFINE ("QRY_FAQ_LIST_COUNT",131);
DEFINE ("QRY_FAQ_LIST",132);
DEFINE ("QRY_FAQ_INFO",133);
DEFINE ("QRY_FAQ_INFO_PREV",134);
DEFINE ("QRY_FAQ_INFO_NEXT",135);
DEFINE ("QRY_FAQE_FILE",136);
DEFINE ("QRY_FAQ_INSERT",137);
DEFINE ("QRY_FAQ_UPDATE",138);
DEFINE ("QRY_FAQ_DELETE",139);
DEFINE ("QRY_USER_COM_LIST",140);
DEFINE ("QRY_USER_COM_INFO",141);
DEFINE ("QRY_USER_COM_INSERT",142);
DEFINE ("QRY_USER_COM_UPDATE",143);
DEFINE ("QRY_USER_UPDATE",144);
DEFINE ("QRY_CODE_CATE_SUB_LIST",145);
DEFINE ("QRY_RESULT_LASTCHECK_LIST_COUNT",146);
DEFINE ("QRY_RESULT_LASTCHECK_LIST",147);
DEFINE ("QRY_RESULT_PC_CHECK_INFO",150);
DEFINE ("QRY_RESULT_PC_CHECK_INFO_PREV",151);
DEFINE ("QRY_RESULT_PC_CHECK_INFO_NEXT",152);
DEFINE ("QRY_RESULT_PC_CHECK_UPDATE",153);
DEFINE ("QRY_RESULT_PC_INFO",154);
DEFINE ("QRY_RESULT_PC_INFO_DETAIL",155);
DEFINE ("QRY_RESULT_PC_DETAIL_INFO_LDISK",156);
DEFINE ("QRY_RESULT_PC_DETAIL_INFO_PDISK",157);
DEFINE ("QRY_RESULT_PC_DETAIL_INFO_MACADDR",158);
DEFINE ("QRY_RESULT_PC_DETAIL_INFO_PROGRAM",159);
DEFINE ("QRY_RESULT_WEAKNESS_COUNT",160);
DEFINE ("QRY_RESULT_VIRUS_COUNT",161);
DEFINE ("QRY_RESULT_PC_WEAKNESS_INFO",162);
DEFINE ("QRY_RESULT_PC_VACCINE_INFO",163);
DEFINE ("QRY_RESULT_PC_VACCINE_DETAIL_INFO",164);
DEFINE ("QRY_RESULT_PC_WINDOW_UPDATE_INFO",165);
DEFINE ("QRY_RESULT_PC_WINDOW_UPDATE_DETAIL_INFO",166);
DEFINE ("QRY_RESULT_CHECK_LIST_COUNT",167);
DEFINE ("QRY_RESULT_CHECK_LIST",168);
DEFINE ("QRY_STAT_PC_CHECK_STATUS",175);
DEFINE ("QRY_STAT_STORAGE_CHECK_STATUS",176);
DEFINE ("QRY_STAT_ORG_CHECK_STATUS",177);
DEFINE ("QRY_STAT_PC_CHECK_DAY",178);
DEFINE ("QRY_STAT_PC_CHECK_MONTH",179);
DEFINE ("QRY_STAT_PC_CHECK_ORG",180);
DEFINE ("QRY_STAT_PC_CHECK_DEPT",181);
DEFINE ("QRY_STAT_PC_CHECK_WEAKNESS",182);
DEFINE ("QRY_STAT_PC_CHECK_VIRUS",183);
DEFINE ("QRY_STAT_USER_PC_OS",190);
DEFINE ("QRY_STAT_USER_PC_MAKER",191);
DEFINE ("QRY_RESULT_PC_CHECKIN",192);
DEFINE ("QRY_ADMIN_MNG_ORG",194);
DEFINE ("QRY_ADMIN_MNG_ORG_INSERT",195);
DEFINE ("QRY_ADMIN_MNG_ORG_DELETE",196);
DEFINE ("QRY_RESULT_LASTCHECK_LIST_EXCEL",197);
DEFINE ("QRY_RESULT_CHECK_LIST_EXCEL",198);
DEFINE ("QRY_POLICY_WEAKNESS",199);
DEFINE ("QRY_POLICY_WEAKNESS_USE_UPDATE",200);
DEFINE ("QRY_SMS_SEND",201);
DEFINE ("QRY_OTP_LOG_INSERT",202);
DEFINE ("QRY_OTP_LOG_INFO",203);
DEFINE ("QRY_OTP_LOG_UPDATE",204);
DEFINE ("QRY_OTP_LOGIN_OK",205);
DEFINE ("QRY_SCAN_CENTER_LIST_COUNT",206);
DEFINE ("QRY_SCAN_CENTER_LIST",207);
DEFINE ("QRY_SCAN_CENTER_INFO",208);
DEFINE ("QRY_SCAN_CENTER_INFO_PREV_NEXT",209);
DEFINE ("QRY_SCAN_CENTER_INSERT",210);
DEFINE ("QRY_SCAN_CENTER_UPDATE",211);
DEFINE ("QRY_SCAN_CENTER_DELETE",212);
DEFINE ("QRY_SCAN_CENTER_CHECK",213);
DEFINE ("QRY_ADMIN_MNG_SCAN_CENTER",214);
DEFINE ("QRY_ADMIN_MNG_SCAN_CENTER_INSERT",215);
DEFINE ("QRY_ADMIN_MNG_SCAN_CENTER_DELETE",216);
DEFINE ("QRY_VCS_RESULT_INFO",217);
DEFINE ("QRY_STAT_SCAN_CENTER_CHECK_STATUS",218);
DEFINE ("QRY_STAT_USER_VCS_STATUS",219);
DEFINE ("QRY_STAT_USER_DEVICE_VCS_STATUS",220);
DEFINE ("QRY_USER_VCS_WEAK_LIST",221);
DEFINE ("QRY_USER_VCS_VIRUS_LIST",222);
DEFINE ("QRY_STAT_USER_DEVICE",223);
DEFINE ("QRY_USER_DEVICE_VCS_COUNT",224);
DEFINE ("QRY_USER_DEVICE_VCS_LIST",225);
DEFINE ("QRY_STAT_USER_WV",226);
DEFINE ("QRY_STAT_COM_USER_CNT",227);
DEFINE ("QRY_VCS_RESULT_DELETE",228);
DEFINE ("QRY_USER_DEVICE_VCS_LIST_EXCEL",229);
DEFINE ("QRY_RESULT_VCS_INFO",230);
DEFINE ("QRY_VCS_SCAN_LOG_INSERT",231);
DEFINE ("QRY_VCS_SCANLOG_LIST_COUNT",232);
DEFINE ("QRY_VCS_SCANLOG_LIST",233);
DEFINE ("QRY_VCS_SCANLOG_LIST_EXCEL",234);
DEFINE ("QRY_VCS_BARCODE_SCANLOG_LIST",235);
DEFINE ("QRY_STAT_COMPANY_VCS_COUNT",236);
DEFINE ("QRY_STAT_COMPANY_VCS_LIST",237);
DEFINE ("QRY_VCS_BARCODE_SCAN_INFO",238);
DEFINE ("QRY_STAT_DEVICE_CHECK_DAY",239);
DEFINE ("QRY_STAT_DEVICE_CHECK_MONTH",240);
DEFINE ("QRY_RESULT_CHECK_LIST_ALL",241);
DEFINE ("QRY_STAT_COMPANY_VCS_LIST_ALL",242);
DEFINE ("QRY_USER_DEVICE_VCS_LIST_ALL",243);
DEFINE ("QRY_RESULT_PC_CHECKOUT",244);
DEFINE ("QRY_ADMIN_DELETE_LOG",245);
DEFINE ("QRY_GET_VCS_USER_INFO",246);
DEFINE ("QRY_RESULT_FILE_LIST_COUNT",247);
DEFINE ("QRY_RESULT_FILE_LIST",248);
DEFINE ("QRY_RESULT_FILE_LIST_EXCEL",249);
DEFINE ("QRY_LOGIN_IP_LIMIT_COUNT",250); 
DEFINE ("QRY_LOGIN_IP_LIMIT_LIST",251);
DEFINE ("QRY_LOGIN_IP_LIMIT_INFO",252);
DEFINE ("QRY_LOGIN_IP_LIMIT_INFO_PREV_NEXT",253);
DEFINE ("QRY_LOGIN_IP_LIMIT_INSERT",254);
DEFINE ("QRY_LOGIN_IP_LIMIT_UPDATE",255);
DEFINE ("QRY_LOGIN_IP_LIMIT_SELECT_BY_SEQ",256);
DEFINE ("QRY_LOGIN_IP_LIMIT_DELETE_BY_SEQ",257);
DEFINE ("QRY_COMMON_IDENTITY_ACCESS",258);
DEFINE ("QRY_COMMON_ADMIN_ALL",259);
DEFINE ("QRY_LOGIN_ATTEMPT_INSERT",260);
DEFINE ("QRY_LOGIN_ATTEMPT_UPDATE",261);
DEFINE ("QRY_LOGIN_ATTEMPT_CNT_GET",262);
DEFINE ("QRY_USER_LOGINATTEMPT_LIST_COUNT",263);
DEFINE ("QRY_USER_LOGINATTEMPT_LIST",264);
DEFINE ("QRY_ADMIN_LOGIN_LOCK_UPDATE",265);
DEFINE ("QRY_COMMON_ADMIN_INFO_PW",266);
//dptr
DEFINE ("QRY_FILE_SIGNATURE_COUNT",267);
DEFINE ("QRY_FILE_SIGNATURE_LIST",268);
DEFINE ("QRY_FILE_SIGNATURE_INFO",269);
DEFINE ("QRY_FILE_SIGNATURE_PREV_NEXT",270);
DEFINE ("QRY_FILE_SIGNATURE_INSERT",271);
DEFINE ("QRY_FILE_SIGNATURE_UPDATE",272);
DEFINE ("QRY_FILE_SIGNATURE_DELETE",273);

DEFINE ("QRY_SIGNATURE_MAPPING_COUNT",274);
DEFINE ("QRY_SIGNATURE_MAPPING_LIST",275);
DEFINE ("QRY_SIGNATURE_MAPPING_INFO",276);
DEFINE ("QRY_SIGNATURE_MAPPING_PREV_NEXT",277);
DEFINE ("QRY_SIGNATURE_MAPPING_INSERT",278);
DEFINE ("QRY_SIGNATURE_MAPPING_UPDATE",279);
DEFINE ("QRY_SIGNATURE_MAPPING_DELETE",280);
DEFINE ("QRY_SIGNATURE_MAPPING_EXCEL",281);
DEFINE ("QRY_QUERY_EDITOR",282);








DEFINE ("QRY_COMMON_ADMIN_MENU",10001);
DEFINE ("QRY_COMMON_DEPT",10002);
DEFINE ("QRY_COMMON_ORG",10003);
DEFINE ("QRY_COMMON_JOBGRADE",10004);
DEFINE ("QRY_COMMON_JOBDUTY",10005);
DEFINE ("QRY_COMMON_JOBPOS",10006);
DEFINE ("QRY_COMMON_MENU",10007);
DEFINE ("QRY_COMMON_EMP_INFO_PW",10008);
DEFINE ("QRY_COMMON_ORG_INFO",10009);
DEFINE ("QRY_COMMON_ORG_USE_ALL",10010);
DEFINE ("QRY_COMMON_CODE",10011);
DEFINE ("QRY_COMMON_EMP_WORK_ALL",10012);
DEFINE ("QRY_COMMON_ORG_EMP_WORK_ALL",10013);
DEFINE ("QRY_COMMON_DEPT_ALL",10014);
DEFINE ("QRY_COMMON_IDENTITY",10015);
DEFINE ("QRY_COMMON_EMP",10016);
DEFINE ("QRY_COMMON_SCAN_CENTER_USE_ALL",10017);
DEFINE ("QRY_COMMON_RENT_ITEM_LIST_INFO",10018);
DEFINE ("QRY_COMMON_ADMIN_MENU_CONFIG",10019);
DEFINE ("QRY_COMMON_ADMIN_MENU_BY_PRESET",10020);
DEFINE ("QRY_COMMON_ADMIN_MENU_BY_ADMIN_LEVEL",10021);
DEFINE ("QRY_COMMON_ADMIN_MNG_SCAN_CENTER_BY_PRESET",10022);






function query($label,$params){

	global $_site_path;
	global $work_log_seq;

	$_query_logging = false;
	
	switch($label){
		
		CASE 1 :
				$sql = " 
					SELECT COUNT(*) AS CNT 
					FROM tb_notice A ";
			break;

		CASE 2 :
			$sql = 
				"SELECT top 3 A.notice_seq, A.gubun, A.title, CONVERT(CHAR(16),A.create_dt,120) as write_date, E.emp_name,A.img_file_path,A.img_file_name,A.pds_file_name,A.pds_file_path
				FROM tb_notice A
					INNER JOIN tb_employee E ON A.create_emp_seq = E.emp_seq
				ORDER BY notice_seq DESC ";
			break;

		CASE 3 :
			$sql = "SELECT COUNT(*) AS CNT 
					FROM tb_v_user vu
						LEFT JOIN tb_v_company vc
							ON vu.v_com_seq = vc.v_com_seq
						LEFT JOIN (
							SELECT v_user_seq,COUNT(v_wvcs_seq) as vcs_cnt,COUNT(weak) as weak_cnt, COUNT(virus) as virus_cnt
							FROM vw_user_vcs_result vcs
								LEFT JOIN tb_scan_center cn
									ON vcs.scan_center_code = cn.scan_center_code
							WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')." 
							GROUP BY v_user_seq ) vcs
							ON vu.v_user_seq = vcs.v_user_seq
					WHERE 1 = 1 ".$params['search_sql'];
			break;
		CASE 4 :
			$sql = " 
				WITH Visitor AS
					(
						SELECT top ".$params['end']."	vu.v_com_seq,vu.v_user_seq,vu.v_user_name,vu.v_email,vu.v_phone,vc.v_com_name
						, dbo.fn_DecryptString(vu.v_email) as v_email_decript
						, dbo.fn_DecryptString(vu.v_phone) as v_phone_decript
						, dbo.fn_DecryptString(vu.v_user_name) as v_user_name_decript
						, vcs.vcs_cnt,vcs.weak_cnt,vcs.virus_cnt,vcs.bad_cnt,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM tb_v_user vu
							LEFT JOIN tb_v_company vc
								ON vu.v_com_seq = vc.v_com_seq
							LEFT JOIN (
								SELECT v_user_seq,COUNT(v_wvcs_seq) as vcs_cnt,COUNT(weak) as weak_cnt, COUNT(virus) as virus_cnt,COUNT(bad) as bad_cnt
								FROM vw_user_vcs_result vcs
									LEFT JOIN tb_scan_center cn
										ON vcs.scan_center_code = cn.scan_center_code
								WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')." 
								GROUP BY v_user_seq ) vcs
								ON vu.v_user_seq = vcs.v_user_seq
						WHERE 1 = 1 ".$params['search_sql']."
					) 
					SELECT a.*
					FROM Visitor  a
					WHERE rnum > ".$params['start']." ";
			break;
		
		case 5 :
			$sql = " 
				SELECT  vu.v_com_seq,vu.v_user_seq,vu.v_user_name,vu.v_email,vu.v_phone,vc.v_com_name
							, dbo.fn_DecryptString(vu.v_user_name) as v_user_name_decript
							, dbo.fn_DecryptString(vu.v_email) as v_email_decript
							, dbo.fn_DecryptString(vu.v_phone) as v_phone_decript
							, vcs.vcs_cnt,vcs.weak_cnt,vcs.virus_cnt,vcs.bad_cnt
						FROM tb_v_user vu
							LEFT JOIN tb_v_company vc
								ON vu.v_com_seq = vc.v_com_seq
							LEFT JOIN (
								SELECT v_user_seq,COUNT(v_wvcs_seq) as vcs_cnt,COUNT(weak) as weak_cnt, COUNT(virus) as virus_cnt,COUNT(bad) as bad_cnt
								FROM vw_user_vcs_result vcs
									LEFT JOIN tb_scan_center cn
										ON vcs.scan_center_code = cn.scan_center_code
								WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')." 
								GROUP BY v_user_seq ) vcs
								ON vu.v_user_seq = vcs.v_user_seq
						WHERE 1 = 1  "
				.$params['search_sql']
				.$params['order_sql'];
			break;
		
		case 6 :
			$sql = " 
				select A.* ,dbo.fn_DecryptString(A.email) AS email_decript, dbo.fn_DecryptString(A.phone_no) AS phone_no_decript , 
					o.org_name, d.dept_name,jg.jgrade_name,jd.jduty_name,jp.jpos_name
				from tb_employee A
					LEFT JOIN tb_organ o ON o.org_id = A.org_id
					LEFT JOIN tb_department d ON d.dept_seq = A.dept_seq
					LEFT JOIN tb_jobgrade jg ON A.jgrade_code = jg.jgrade_code
					LEFT JOIN tb_jobduty jd ON A.jduty_code = jd.jduty_code
					LEFT JOIN tb_jobpos jp ON A.jpos_code = jp.jpos_code
				where A.emp_seq = '".$params['emp_seq']."' ";

			break;
		
		case 7 :
			$sql = "
				UPDATE tb_employee 
				SET      email = '".$params['email_encrypt']."'
					, phone_no = '".$params['phone_no_encrypt']."'
					".(empty($params['emp_pwd_hash'])? "" : ", emp_pwd = '".$params['emp_pwd_hash']."' ")."
					".(empty($params['emp_pwd_hash'])? "" : ", pwd_change_date = getdate()")."
					".(empty($params['emp_pwd_hash'])? "" : ", pwd_change_emp = '".$params['emp_seq']."' ")."
				WHERE emp_seq = '".$params['emp_seq']."' ";
			break;

		case 8 :
			$sql = "
				SELECT 
					v_user_seq,v_user_name,v_email,v_phone,
					dbo.fn_DecryptString(v_email) as v_email_decript,
					dbo.fn_DecryptString(v_phone) as v_phone_decript,
					u.use_yn as v_use_yn,c.v_com_seq,c.v_com_name,c.v_ceo_name,v_com_code_1,v_com_code_2,v_com_code_3,v_com_gubun_1,v_com_gubun_2,c.use_yn as com_use_yn
				FROM tb_v_user u
					LEFT JOIN tb_v_company c ON u.v_com_seq = c.v_com_seq
				WHERE u.v_user_seq = '".$params['v_user_seq']."' ";
			break;
		
		
		case 9 :
			$sql = "
				SELECT TOP 1 *
				FROM tb_policy 
				ORDER BY policy_seq DESC ";
			break;

		case 10 :
			$sql = "
				INSERT INTO dbo.tb_policy (
						admin_pwd_change_term
						,connection_yn
						,scrlock_yn
						,windows_update_yn
						,vaccine_check_yn
						,vacc_patch_term
						,vacc_scan_type
						,window_weakness_check_yn
						,scrlock_warn_comment
						,ftp_type
						,ftp_server
						,ftp_port
						,web_type
						,web_server
						,web_port
						,app_update_server
						,app_api_server
						,mail_server
						,mail_port
						,mail_id
						,mail_pwd
						,mail_type
						,sms_type
						,sms_server
						,sms_port
						,sms_id
						,sms_pwd
						,sms_db
						,sms_table
						,sms_url
						,sms_send_telno
						,otp_yn
						,create_dt
						,create_emp_seq
						,windows_update_term
						,checkin_pc_term
						,checkin_kiosk_term
						,data_keep_day
						,checkin_kiosk_in_type
						,checkin_file_send_type
						,login_attempt_cnt
						,login_ip_limit_yn
						,file_scan_yn
						,db_encription_kind
						,db_encription_flag
						,v3_use_yn
						,eset_use_yn
						,file_scan_device
						,checkin_file_send_device
						,kiosk_data_delete_day
						,visit_checkout_batch_yn
				) VALUES (
						'".$params["admin_pwd_change_term"]."'
						,'".$params["connection_yn"]."'
						,'".$params["scrlock_yn"]."'
						,'".$params["windows_update_yn"]."'
						,'".$params["vaccine_check_yn"]."'
						,'".$params["vacc_patch_term"]."'
						,'".$params["vacc_scan_type"]."'
						,'".$params["window_weakness_check_yn"]."'
						,N'".$params["scrlock_warn_comment"]."'
						,'".$params["ftp_type"]."'
						,'".$params["ftp_server"]."'
						,'".$params["ftp_port"]."'
						,'".$params["web_type"]."'
						,'".$params["web_server"]."'
						,'".$params["web_port"]."'
						,'".$params["app_update_server"]."'
						,'".$params["app_api_server"]."'
						,'".$params["mail_server"]."'
						,'".$params["mail_port"]."'
						,'".$params["mail_id"]."'
						,N'".$params["mail_pwd"]."'
						,'".$params["mail_type"]."'
						,'".$params["sms_type"]."'
						,'".$params["sms_server"]."'
						,'".$params["sms_port"]."'
						,'".$params["sms_id"]."'
						,N'".$params["sms_pwd"]."'
						,N'".$params["sms_db"]."'
						,'".$params["sms_table"]."'
						,N'".$params["sms_url"]."'
						,'".$params["sms_send_telno"]."'
						,'".$params["otp_yn"]."'
						,getdate()
						,'".$params["create_emp_seq"]."'
						,'".$params["windows_update_term"]."'
						,'".$params["checkin_pc_term"]."'
						,'".$params["checkin_kiosk_term"]."'
						,'".$params["data_keep_day"]."'
						,'".$params["checkin_kiosk_in_type"]."'
						,'".$params["checkin_file_send_type"]."'
						,'".$params['login_attempt_cnt']."'
						,'".$params['login_ip_limit_yn']."'
						,'".$params['file_scan_yn']."'
						,'".$params['db_encription_kind']."'
						,'".$params['db_encription_flag']."'
						,'".$params['v3_use_yn']."'
						,'".$params['eset_use_yn']."'
						,'".$params['file_scan_device']."'
						,'".$params['checkin_file_send_device']."'
						,'".$params['kiosk_data_delete_day']."'
						,'".$params['visit_checkout_batch_yn']."'
					)";
			break;
		
		
		case 11 :
			$sql = "SELECT * FROM tb_system WHERE use_yn='Y' ";
			break;

		case 12 :
			$sql = "
				UPDATE tb_company
				SET	ver_id='".$params["ver_id"]."'
				WHERE com_id='".$params["com_id"]."' ";
			break;

		case 13 :
			$sql = "
				SELECT 
					TOP 1 emp_seq,emp_no, emp_name, emp_pwd, org_id, dept_seq, use_lang ,admin_level,pwd_change_emp,
					phone_no,LOGIN_LOCK_YN,LOGIN_LOCK_TYPE,dbo.fn_DecryptString(phone_no) AS phone_no_decript ,
					CONVERT(varchar,pwd_change_date,21) as pwd_change_date, 
					CONVERT(varchar,create_dt,21) as create_dt
				FROM tb_employee 
				WHERE 
					work_yn = 'Y' ".$params["search_sql"];
			break;

		case 14 :
			$sql = "INSERT INTO tb_login_log(emp_seq,ip_addr,login_dt,LOGIN_YN,LOGIN_FAIL_CNT,LOGIN_LOCK_YN,LOGIN_LOCK_TYPE) VALUES ( 
						'".$params["emp_seq"]."', '".$params["ip"]."',getdate(),'".$params["login_yn"]."','".$params["login_fail_cnt"]."','".$params["login_lock_yn"]."','".$params["login_lock_type"]."')";
			break;

		case 15 :
			$sql = "SELECT convert(varchar(10),pwd_change_date,21) as pwd_change_date, pwd_change_emp FROM tb_employee WhERE emp_seq = '".$params["emp_seq"]."' ";
			break;

		case 16 :
			$sql = "
				UPDATE tb_employee 
				SET     emp_pwd = '".$params["emp_pwd_hash"]."'
					, pwd_change_date = getdate()
					, pwd_change_emp ='".$params["pwd_change_emp_seq"]."'
				WHERE emp_seq ='".$params["emp_seq"]."' ";
			break;

		case 17 :
			$sql = "SELECT COUNT(*) AS CNT FROM tb_employee A WHERE ".getCheckOrgAuthQuery('org_id')." ".$params['search_sql'];
			break;
		
		case 18 :
			$sql = " WITH myUserInout AS
					(
						select top ".$params['end']." A.*, dbo.fn_DecryptString(A.email) AS email_decript, dbo.fn_DecryptString(A.phone_no) AS phone_no_decript , CONVERT(varchar(19), A.create_dt, 21) as cr_dt, o.org_name, d.dept_name, jg.jgrade_name,
							ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						from tb_employee A
							LEFT JOIN tb_organ o ON o.org_id = A.org_id
							LEFT JOIN tb_department d ON d.dept_seq = A.dept_seq
							LEFT JOIN tb_jobgrade jg ON jg.jgrade_code = A.jgrade_code
						where ".getCheckOrgAuthQuery('A.org_id')."
							".$params['search_sql']."
					) 
					SELECT a.*
					FROM myUserInout  a
					WHERE rnum > ".$params['start']." ";
							
			break;
		
		case 19 :
			$sql = " SELECT A.* , dbo.fn_DecryptString(A.email) AS email_decript, dbo.fn_DecryptString(A.phone_no) AS phone_no_decript ,CONVERT(char(10),A.create_dt,21) cr_dt, o.org_name, d.dept_name,jgrade_name,jduty_name,jpos_name
					FROM tb_employee A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
						LEFT JOIN tb_department d ON d.dept_seq = A.dept_seq
						LEFT JOIN tb_jobgrade jg ON A.jgrade_code = jg.jgrade_code
						LEFT JOIN tb_jobduty jd ON A.jduty_code = jd.jduty_code
						LEFT JOIN tb_jobpos jp ON A.jpos_code = jp.jpos_code
					WHERE ".getCheckOrgAuthQuery('A.org_id')."
						".$params['search_sql']." ".$params['order_sql']." ";
			break;
		
		case 20 :
			$sql = " WITH myUserInout AS
				(
					select A.* , dbo.fn_DecryptString(A.email) AS email_decript, dbo.fn_DecryptString(A.phone_no) AS phone_no_decript, o.org_name, d.dept_name,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_employee A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
						LEFT JOIN tb_department d ON d.dept_seq = A.dept_seq
					where ".getCheckOrgAuthQuery('A.org_id')."
						".$params['search_sql']."
				) 
				SELECT a.*
				FROM myUserInout  a
				WHERE a.emp_seq = '".$params['emp_seq']."' ";
			break;

		case 21 :
			$sql = " WITH myUserInout AS
				(
					select A.emp_seq, 
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_employee A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
						LEFT JOIN tb_department d ON d.dept_seq = A.dept_seq
					where ".getCheckOrgAuthQuery('A.org_id')."
						".$params['search_sql']."
				) 
				SELECT TOP 1 a.emp_seq
				FROM myUserInout  a  
				WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc ";
			break;

		case 22 :
			$sql = " WITH myUserInout AS
				(
					select A.emp_seq, 
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_employee A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
						LEFT JOIN tb_department d ON d.dept_seq = A.dept_seq
					where ".getCheckOrgAuthQuery('A.org_id')."
						".$params['search_sql']."
				) 
				SELECT TOP 1 a.emp_seq
				FROM myUserInout  a  
				 WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc  ";
			break;

		case 23 :
			$sql = 
				"INSERT INTO tb_employee 
					( emp_no, emp_name, emp_pwd, phone_no, email, org_id ,dept_seq, jpos_code, jgrade_code, jduty_code, use_lang, work_yn, agree_yn, create_emp_seq, create_dt,admin_level )
				VALUES 
					( '".$params['emp_no']."', '".$params['emp_name_encrypt']."', '".$params['emp_pwd_hash']."', '".$params['phone_no_encrypt']."', '".$params['email_encrypt']."', '".$params['org_id']."', '".$params['dept_seq']."', '".$params['jpos_code']."', '".$params['jgrade_code']."', '".$params['jduty_code']."', '".$params['use_lang']."', '".$params['work_yn']."', '".$params['agree_yn']."', '".$params['login_emp_seq']."', '".$params['c_date']."','".$params['admin_level']."') ;";
			

			break;

		case 24 :
			$sql = "	INSERT INTO  tb_admin_menu_auth (emp_seq,create_date,create_emp_seq)
					Values ('".$params['emp_seq']."','".date('YmdHis')."','".$params['login_emp_seq']."');
					INSERT INTO tb_admin_menu (menu_code,create_emp_seq,create_dt,emp_seq,page_code,exec_auth,admin_menu_auth_seq)
					SELECT value,'".$params['login_emp_seq']."',getdate(),'".$params['emp_seq']."','all','C,R,U,D,P', (SELECT SCOPE_IDENTITY())
					FROM	dbo.fn_split('".$params['strMenu']."',',') ";
			break;

		case 25 :
			$sql = "UPDATE tb_employee 
			  SET      emp_name = '".$params['emp_name_encrypt']."'
					".(empty($params['emp_pwd'])? "" : ", emp_pwd = '".$params['emp_pwd_hash']."' ")."
					, phone_no = '".$params['phone_no_encrypt']."'
					, email = '".$params['email_encrypt']."'
					, org_id  = '".$params['org_id']."'
					, dept_seq = '".$params['dept_seq']."'
					, jpos_code = '".$params['jpos_code']."'
					, jgrade_code = '".$params['jgrade_code']."'
					, jduty_code = '".$params['jduty_code']."'
					, use_lang = '".$params['use_lang']."'
					, work_yn = '".$params['work_yn']."'
					, agree_yn = '".$params['agree_yn']."'
					, modify_emp_seq = '".$params['login_emp_seq']."'
					, modify_dt = getdate()
					, admin_level = '".$params['admin_level']."'
					".(empty($params['emp_pwd'])? "" : ", pwd_change_date = getdate() ")."
					".(empty($params['emp_pwd'])? "" : ", pwd_change_emp = '".$params['login_emp_seq']."' ")."
			  WHERE emp_seq='".$params['emp_seq']."' ";
			break;

		case 26 :
			$sql = "DELETE FROM tb_admin_menu WHERE emp_seq = '".$params['emp_seq']."'  ";
			break;

		case 27 :
			$sql = "DELETE FROM tb_employee WHERE emp_seq='".$params['emp_seq']."' ";
			break;
		
		case 28 :
			$sql = " 
				SELECT COUNT(*) AS CNT 
				FROM tb_app_update
				WHERE 1=1 ".$params['search_sql'];
			break;

		case 29 :
			$sql = " WITH AppUpdate AS
				(
					SELECT top ".$params['end']." app_seq, gubun, app_name, real_name, convert(varchar,patch_dt,120) as patch_dt,memo,file_name,server_path,use_yn,file_type,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_app_update
					WHERE 1=1 ".$params['search_sql']."
				) 
				SELECT * 
				FROM AppUpdate 
				WHERE rnum > ".$params['start']." ";
			break;
		
		case 30 :
			$sql = " WITH AppUpdate AS
			(
				SELECT	app_seq,gubun,app_name,file_name,real_name,server_path,convert(varchar,patch_dt,120) as patch_dt,install_path,memo,
						convert(varchar,create_dt,120) as create_dt,convert(varchar,modify_dt,120) as modify_dt,use_yn,ver,create_emp_seq,modify_emp_seq,app_update_kiosk,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum,
						(SELECT emp_name FROM tb_employee WHERE emp_seq = t.create_emp_seq) as create_emp,
						(SELECT emp_name FROM tb_employee WHERE emp_seq = t.modify_emp_seq ) as modify_emp
				FROM tb_app_update t
				WHERE 1=1 ".$params['search_sql']."
			) 
			SELECT app.*
			FROM AppUpdate app 
			WHERE app_seq = '".$params['app_seq']."' ";
			
			break;
		
		case 31 :
			$sql = " WITH AppUpdate AS
				(
					SELECT	app_seq,
							ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_app_update
					WHERE 1=1 ".$params['search_sql']."
				) 
				SELECT TOP 1 app.*
				FROM AppUpdate app   
				WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc ";
			break;
		
		case 32 :
			$sql = " WITH AppUpdate AS
				(
					SELECT	app_seq,
							ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_app_update
					WHERE 1=1 ".$params['search_sql']."
				) 
				SELECT TOP 1 app.*
				FROM AppUpdate app   
				WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc ";
			break;

		case 33 :
			$sql = " SELECT   *
					FROM tb_app_update 
					WHERE app_seq = '".$params['app_seq']."' ";
		
			break;
		
		case 34 :
			$sql  = "
				INSERT INTO tb_app_update ( 
					[com_id] ,[app_name],[ver],[file_size],[server_path],[install_path],[patch_dt],[use_yn],[create_emp_seq],[create_dt],[real_name],[memo],[gubun],[file_name],[file_type],[app_update_kiosk]
				)VALUES (
					'".$params['com_id']."','".$params['app_name']."','".$params['app_ver']."','".$params['file_size']."','".$params['up_savedir']."','".$params['install_path']."','".$params['patch_dt']."','".$params['use_yn']."','".$params['emp_seq']."',getdate(),'".$params['file_real_name']."','".$params['memo']."','".$params['gubun']."','".$params['up_file']."','".$params['file_type']."','".$params['kiosk']."') ";
			
			break;

		case 35 :
			$sql  = "
				UPDATE tb_app_update  
				SET   gubun= '".$params['gubun']."'
						, file_type = '".$params['file_type']."'
						, app_name = N'".$params['app_name']."'
						, ver = '".$params['app_ver']."'
						".$params['sql_upfile']."
						, patch_dt = '".$params['patch_dt']."'
						, install_path = '".$params['install_path']."'
						, memo = N'".$params['memo']."'
						, use_yn = '".$params['use_yn']."'
						, app_update_kiosk = '".$params['kiosk']."'
						, modify_dt = getdate()
						, modify_emp_seq = '".$params['emp_seq']."'
				WHERE app_seq  = '".$params['app_seq']."' ";
			break;
		
		case 36 :
			$sql  = "DELETE FROM tb_app_update WHERE app_seq =  '".$params['app_seq']."' ";
			break;

		case 37 :
			$sql = "
				SELECT	code_seq,code_key,code_name,depth,sort,fix_yn,use_yn,p_code_seq,create_emp_seq,CONVERT(char(10),create_dt,120) as create_dt,modify_emp_seq,CONVERT(char(10),modify_dt,120) as modify_dt,refer_val
				FROM tb_code
				WHERE	show_yn = '".$params['show_yn']."' 
					".$params['search_sql']."
				ORDER BY code_key,sort,code_seq ";
			break;

		case 38 :
			$sql = "
				SELECT	code_seq,code_key,code_name,depth,sort,fix_yn,use_yn,p_code_seq
				FROM	tb_code 
				WHERE	code_seq =  '".$params['cate_code_seq']."'  ";
			break;
		
		case 39 :
			$sql = " WITH MngCode AS
			(
				SELECT code_seq,code_key,code_name,depth,sort,fix_yn,use_yn,p_code_seq,refer_val
					,ROW_NUMBER() OVER(ORDER BY code_key, sort, code_seq) as rnum
				FROM  tb_code
				WHERE show_yn='Y'
					AND code_key = '".$params['code_key']."'
					AND p_code_seq > 0
			) 
			SELECT * 
			FROM MngCode 
			WHERE code_seq = '".$params['detail_code_seq']."' ";
			break;

		case 40 :
			$sql = " WITH MngCode AS
					(
						SELECT	code_seq
							,ROW_NUMBER() OVER( ORDER BY code_key, sort, code_seq ) as rnum
						FROM	tb_code 
						WHERE	show_yn='Y'
							AND code_key = '".$params['code_key']."'
							AND p_code_seq > 0
					) 
					SELECT TOP 1 a.code_seq
					FROM MngCode  a  
					WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc ";
			break;

		case 41 :
			$sql = " WITH MngCode AS
					(
						SELECT	code_seq
							,ROW_NUMBER() OVER( ORDER BY code_key, sort, code_seq ) as rnum
						FROM	tb_code 
						WHERE	show_yn='Y'
							AND code_key = '".$params['code_key']."'
							AND p_code_seq > 0
					) 
					SELECT TOP 1 a.code_seq
					FROM MngCode  a  
					WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc  ";
			break;
		
		case 42 :
			$sql = "
				SELECT	code_key,code_name,code_seq,refer_val
				FROM 	tb_code
				WHERE	show_yn='".$params['show_yn']."'
					AND p_code_seq = 0 
					".$params['search_sql']."
				ORDER BY code_name,sort,code_seq ";
			break;

		case 43 :
			$sql = "
				INSERT INTO tb_code (
						code_key,code_name,depth,sort,fix_yn,use_yn,p_code_seq,create_emp_seq,create_dt,show_yn,refer_val
				)VALUES(
						'".$params['code_key']."','".$params['code_name']."','".$params['depth']."','".$params['sort']."','".$params['fix_yn']."','".$params['useyn']."','".$params['p_code_seq']."','".$params['login_emp_seq']."',getdate(),'Y','".$params['refer_val']."'
				)";
			break;

		case 44 :
				$sql = "
					UPDATE tb_code
					SET	code_name = N'".$params['code_name']."'
						,code_key ='".$params['code_key']."'
						,sort = '".$params['sort']."'
						,use_yn = '".$params['useyn']."'
						,p_code_seq = '".$params['p_code_seq']."'
						,modify_dt = getdate()
						,modify_emp_seq = '".$params['login_emp_seq']."'
						,refer_val = '".$params['refer_val']."'
					WHERE code_seq = '".$params['code_seq']."'
				";
			break;

		case 45 :
			$sql = "DELETE FROM tb_code WHERE code_seq = '".$params['code_seq']."'";
			break;

		case 46 :
			$sql = " SELECT count(*) as cnt FROM tb_code WHERE show_yn='Y' AND p_code_seq = '".$params['code_seq']."'";
			break;

		case 47 :
			$sql = "
					SELECT  COUNT(*) AS CNT
					FROM	tb_organ o
						INNER JOIN vw_department p ON o.org_id = p.org_id
						LEFT JOIN tb_employee e ON p.chief_emp_seq = e.emp_seq
					WHERE ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql'];
			break;

		case 48 :
			$sql = " WITH Dept AS
				(
					SELECT  top ".$params['end']."  o.org_id,o.org_name,p.dept_name,p.lvl,p.dept_seq,p.p_dept_seq,p.use_yn,p.sort,p.dept_auth1,p.dept_auth2,p.dept_auth3,p.chief_emp_seq,e.emp_name
							,ROW_NUMBER() OVER(ORDER BY o.org_name,p.hierarchy) as rnum
					FROM	tb_organ o
						INNER JOIN vw_department p ON o.org_id = p.org_id
						LEFT JOIN tb_employee e ON p.chief_emp_seq = e.emp_seq
					WHERE ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT *
				FROM Dept 
				WHERE rnum > ".$params['start']." ";
			break;
		
		case 49 :
			$sql = "
				 WITH Dept AS (					
					SELECT  p.org_id, p.dept_name,p.dept_seq,p.p_dept_seq,p.use_yn,p.sort,p.dept_auth1,p.dept_auth2,p.dept_auth3,p.chief_emp_seq
						,ROW_NUMBER() OVER(ORDER BY o.org_name,p.hierarchy) as rnum
					FROM	tb_organ o
						INNER JOIN vw_department p ON o.org_id = p.org_id
						LEFT JOIN tb_employee e ON p.chief_emp_seq = e.emp_seq
					WHERE ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT *
				FROM Dept 
				WHERE dept_seq= '".$params['dept_seq']."'";
			break;
		
		case 50 :
			$sql = "
				WITH Dept AS (					
					SELECT  p.dept_seq,ROW_NUMBER() OVER(ORDER BY o.org_name,p.hierarchy) as rnum
					FROM	tb_organ o
						INNER JOIN vw_department p ON o.org_id = p.org_id
						LEFT JOIN tb_employee e ON p.chief_emp_seq = e.emp_seq
					WHERE ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT TOP 1 dept_seq
				FROM Dept  
				WHERE rnum > '".$params['rnum']."' order by rnum asc";
			break;

		case 51 :
			$sql = "
				WITH Dept AS (					
					SELECT  p.dept_seq,ROW_NUMBER() OVER(ORDER BY o.org_name,p.hierarchy) as rnum
					FROM	tb_organ o
						INNER JOIN vw_department p ON o.org_id = p.org_id
						LEFT JOIN tb_employee e ON p.chief_emp_seq = e.emp_seq
					WHERE ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT TOP 1 dept_seq
				FROM Dept  
				WHERE rnum <  '".$params['rnum']."'  order by rnum desc ";
			break;

		case 52 :
			$sql = "INSERT INTO tb_department ( org_id, dept_name,  p_dept_seq, depth, chief_emp_seq, use_yn, sort, dept_auth1, dept_auth2, dept_auth3, create_emp_seq, create_dt)
				VALUES('".$params['org_id']."', N'".$params['dept_name']."',  '".$params['p_dept_seq']."', '".$params['depth']."', ".$params['dept_chief_seq'].", '".$params['use_yn']."', ".$params['sort'].", '".$params['dept_auth1']."', '".$params['dept_auth2']."', '".$params['dept_auth3']."', '".$params['create_emp_seq']."', '".$params['create_dt']."')";
			break;

		case 53 :
			$sql = "INSERT INTO tb_department ( org_id, dept_name,  p_dept_seq, depth, chief_emp_seq, use_yn, sort, dept_auth1, dept_auth2, dept_auth3, create_emp_seq, create_dt)
					SELECT  '".$params['org_id']."', N'".$params['dept_name']."',  ".$params['p_dept_seq'].", depth+1, ".$params['dept_chief_seq'].", '".$params['use_yn']."', ".$params['sort'].", '".$params['dept_auth1']."', '".$params['dept_auth2']."', '".$params['dept_auth3']."', '".$params['create_emp_seq']."', '".$params['create_dt']."'
					FROM   tb_department
					WHERE dept_seq = '".$params['p_dept_seq']."' ";
			break;
		
		case 54 :
			$sql = "UPDATE tb_department 
			SET      org_id = '".$params['org_id']."' 
					 , p_dept_seq = '".$params['p_dept_seq']."'
					 , dept_name= N'".$params['dept_name']."'
					 , chief_emp_seq = ".$params['dept_chief_seq']."
					 , use_yn='".$params['use_yn']."'
					 , sort= ".$params['sort']."
					 , depth = ".$params['depth_sql']."
					 , dept_auth1='".$params['dept_auth1']."'
					 , dept_auth2='".$params['dept_auth2']."'
					 , dept_auth3='".$params['dept_auth3']."'
					 , modify_emp_seq='".$params['login_emp_seq']."'
					 , modify_dt='".$params['c_date']."'
			WHERE dept_seq='".$params['dept_seq']."' ";
			break;

		case 55 :
			$sql = "SELECT count(*) as cnt FROM tb_department WHERE p_dept_seq = '".$params['dept_seq']."' ";
			break;

		case 56 :
			$sql = "SELECT count(*) as cnt FROM tb_employee WHERE dept_seq = '".$params['dept_seq']."' ";
			break;

		case 57 :
			$sql = "DELETE FROM tb_department WHERE dept_seq='".$params['dept_seq']."' ";
			break;
		
		case 58 :
			$sql = "
				SELECT org_id,org_name,use_yn
				FROM tb_organ
				WHERE ".getCheckOrgAuthQuery("org_id")."
				ORDER BY org_name
			";
			break;

		case 59 :
			$sql = "
				SELECT org_id,p_dept_seq,dept_seq,dept_name,use_yn
				FROM vw_department
				WHERE ".getCheckOrgAuthQuery("org_id")."
				ORDER BY hierarchy
			";
			break;

		case 60 :
			$sql = "
				SELECT org_id,dept_seq,emp_seq,emp_name,work_yn
				FROM tb_employee
				WHERE ".getCheckOrgAuthQuery("org_id")."
				ORDER BY emp_seq
			";
			break;

		case 61 :
			$sql = "
				SELECT org_id,org_name,com_id,memo,use_yn 
				FROM   tb_organ
				WHERE  ".getCheckOrgAuthQuery("org_id")." 
					AND org_id = '".$params['org_id']."' ";
			break;

		case 62 :
			$sql = "
			 SELECT  org_id,dept_seq,dept_name,p_dept_seq,sort,chief_emp_seq,use_yn,dept_auth1,dept_auth2,dept_auth3
				FROM	tb_department
				WHERE ".getCheckOrgAuthQuery('org_id')." 
					AND dept_seq = '".$params['dept_seq']."' ";
			break;

		case 63 :
			$sql = "SELECT A.* , o.org_name, d.dept_name, dbo.fn_DecryptString(A.email) AS email_decript, dbo.fn_DecryptString(A.phone_no) AS phone_no_decript
				FROM tb_employee A
					LEFT JOIN tb_organ o ON o.org_id = A.org_id
					LEFT JOIN tb_department d ON d.dept_seq = A.dept_seq
				WHERE ".getCheckOrgAuthQuery('A.org_id')."  
					AND A.emp_seq = '".$params['emp_seq']."' ";
			break;

		case 64 :
			$sql = "INSERT INTO tb_organ (org_id,org_name,com_id,memo,create_emp_seq,create_dt,use_yn)
	    		VALUES ('".$params['org_id']."','".$params['org_name']."','".$params['com_id']."','".$params['memo']."','".$params['login_emp_seq']."',getdate(),'".$params['use_yn']."') ";
			break;

		case 65 :
			$sql = "UPDATE tb_organ 
			  SET     com_id='".$params['com_id']."'
					 , org_name= N'".$params['org_name']."'
					 , memo= N'".$params['memo']."'
					 , use_yn='".$params['use_yn']."'
					 , modify_emp_seq = '".$params['login_emp_seq']."'
					 , modify_dt = getdate()
			  WHERE org_id= '".$params['org_id']."' ";
			break;

		case 66 :
			$sql = " DELETE FROM tb_organ WHERE org_id = '".$params['org_id']."' ";
			break;

		case 67 :
			$sql = "SELECT COUNT(*) cnt FROM tb_employee WHERE org_id = '".$params['org_id']."' ";
			break;

		case 68 :
			$sql = "SELECT COUNT(*) cnt FROM tb_department WHERE org_id ='".$params['org_id']."' ";
			break;

		case 69 :
			$sql = "SELECT COUNT(*) cnt FROM tb_organ WHERE org_id = '".$params['org_id']."' ";
			break;
		
		case 70 :
			$sql = "
				SELECT pc_seq,pc_id,pc_model,pc_manufacturer 
				FROM tb_pc 
				WHERE use_yn='Y' 
					AND emp_seq = (SELECT emp_seq FROM tb_employee WHERE ".getCheckOrgAuthQuery('org_id')." AND emp_no='".$params['user_id']."')";
			break;

		case 71 :
			$sql = "SELECT COUNT(*) AS CNT FROM tb_group ";
			break;

		case 72 :
			$sql = " WITH MngGroup AS
				(
					select top ".$params['end']." A.group_seq, A.group_name, A.memo, CONVERT(varchar(19), create_dt, 21) as create_dt, CONVERT(varchar(19), modify_dt, 21) as modify_dt
					, ISNULL(dbo.fn_group_org_info(A.group_seq), '-') AS org_name
					, ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_group A
					where 1 = 1 
				) 
				SELECT * 
				FROM MngGroup 
				WHERE rnum > ".$params['start']." ";
			break;

		case 73 :
			$sql = " 
				WITH MngGroup AS (
					SELECT	 group_seq,group_name,memo 
							,ROW_NUMBER() OVER( ORDER BY group_name ASC, group_seq DESC  ) as rnum
					FROM	tb_group
				) 
				SELECT *
				FROM	MngGroup
				WHERE	group_seq = '".$params['group_seq']."' ";
			break;

		case 74 :
			$sql = " 
				WITH MngGroup AS (
						SELECT	 group_seq
								,ROW_NUMBER() OVER( ORDER BY group_name ASC, group_seq DESC  ) as rnum
						FROM	tb_group
					) 
				SELECT  TOP 1 *
				FROM	MngGroup
				WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc";
			break;

		case 75 :
			$sql = " 
				WITH MngGroup AS (
						SELECT	 group_seq
								,ROW_NUMBER() OVER( ORDER BY group_name ASC, group_seq DESC  ) as rnum
						FROM	tb_group
					) 
				SELECT  TOP 1 *
				FROM	MngGroup
				WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc ";
			break;

		case 76 :
			$sql = " 
				SELECT  A.org_id, A.org_name, A.memo,
				 (SELECT COUNT(*) FROM tb_group_org 
					WHERE org_id = A.org_id ".$params['subSql']." ) AS CHECK_DIV
				 FROM   tb_organ A
					LEFT JOIN tb_group_org C ON C.org_id = A.org_id 
					LEFT JOIN tb_group B ON C.group_seq = B.group_seq 
				 WHERE A.use_yn='Y' ".$params['subsubSql']."
				 ORDER BY A.org_name ASC
					";
			break;

		case 77 :
			$sql = "INSERT INTO tb_group ( group_name,memo,create_emp_seq,create_dt )
				VALUES ( N'".$params['group_name']."',  N'".$params['memo']."', '".$params['login_emp_seq']."', '".$params['c_date']."'); ";
	
			$sql .= "INSERT INTO tb_group_org ( group_seq, org_id, create_emp_seq, create_dt )
						SELECT IDENT_CURRENT('tb_group') , org_id, '".$params['login_emp_seq']."', '".$params['c_date']."'
						FROM  tb_organ
						WHERE org_id IN (".$params['org_id_insert'].")
					";
			break;

		case 78 :
			$sql = "UPDATE tb_group 
					  SET     group_name = N'".$params['group_name']."'
							, memo = N'".$params['memo']."'
							, modify_emp_seq = '".$params['login_emp_seq']."'
							, modify_dt = '".$params['c_date']."'
					  WHERE group_seq='".$params['group_seq']."'; ";

			$sql .= "DELETE FROM tb_group_org WHERE group_seq='".$params['group_seq']."'; ";

			$sql .= "INSERT INTO tb_group_org ( group_seq, org_id, create_emp_seq, create_dt )
						SELECT '".$params['group_seq']."' , org_id, '".$params['login_emp_seq']."', '".$params['c_date']."'
						FROM  tb_organ
						WHERE org_id IN (".$params['org_id_insert'].");
					";
			break;

		case 79 :
			$sql  = "DELETE FROM tb_group WHERE group_seq='".$params['group_seq']."'; ";
			$sql .= "DELETE FROM tb_group_org WHERE group_seq='".$params['group_seq']."'; ";
			break;

		case 80 :
			$sql = "SELECT COUNT(*) AS CNT 
				FROM tb_ip_addr a
					LEFT JOIN tb_organ o ON o.org_id = a.org_id 
				WHERE ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']." ";
			break;

		case 81 :
			$sql = " WITH IPAddr AS
				(
					select top ".$params['end']." A.* , CONVERT(varchar(19), A.create_dt, 21) as cr_dt, o.org_name,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_ip_addr A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
					where ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT * 
				FROM IPAddr 
				WHERE rnum > ".$params['start']." ";
			break;

		case 82 :
			$sql = " WITH IPAddr AS
				(
					select A.* ,  o.org_name,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_ip_addr A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
					where ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT * 
				FROM IPAddr 
				WHERE ip_seq = '".$params['ip_seq']."' ";
			break;

		case 83 :
			$sql = " WITH IPAddr AS
				(
					select A.ip_seq,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_ip_addr A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
					where ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT TOP 1 a.ip_seq
				FROM IPAddr  a 
				WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc  ";
			break;

		case 84 :
			$sql = " WITH IPAddr AS
				(
					select A.ip_seq,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_ip_addr A
						LEFT JOIN tb_organ o ON o.org_id = A.org_id
					where ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT TOP 1 a.ip_seq
				FROM IPAddr  a 
				WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc ";
			break;

		case 85 :
			$sql = "INSERT INTO tb_ip_addr (use_yn,create_emp_seq,create_dt,org_id,memo,start_ip,end_ip)
	    		VALUES ( '".$params['use_yn']."', '".$params['login_emp_seq']."', getdate(), '".$params['org_id']."', '".$params['memo']."', '".$params['ip_addr_start']."' ,'".$params['ip_addr_end']."') ";
			break;

		case 86 :
			$sql = "
				UPDATE tb_ip_addr 
				SET       org_id='".$params['org_id']."'
						 , start_ip='".$params['ip_addr_start']."'
						 , end_ip='".$params['ip_addr_end']."'
						 , use_yn='".$params['use_yn']."'
						 , memo='".$params['memo']."'
						 , modify_emp_seq='".$params['login_emp_seq']."'
						 , modify_dt=getdate()
				WHERE ip_seq='".$params['ip_seq']."' ";
			break;

		case 87 :
			$sql = "DELETE FROM tb_ip_addr WHERE ip_seq='".$params['ip_seq']."' ";
			break;

		case 88 :
			$sql  = "SELECT jpos_seq, jpos_code, jpos_name, sort, use_yn, convert(varchar(10), create_dt, 21) as create_ymd ";
			$sql .= "FROM tb_jobpos ORDER BY sort ASC, jpos_seq DESC ";
			break;

		case 89 :
			$sql  = "SELECT jduty_seq, jduty_code, jduty_name, sort, use_yn, convert(varchar(10), create_dt, 21) as create_ymd ";
			$sql .= "FROM tb_jobduty ORDER BY sort ASC,jduty_seq DESC ";
			break;

		case 90 :
			$sql  = "SELECT jgrade_seq, jgrade_code, jgrade_name, sort, use_yn, convert(varchar(10), create_dt, 21) as create_ymd ";
			$sql .= "FROM tb_jobgrade ORDER BY sort ASC, jgrade_seq DESC ";
			break;

		case 91 :
			$sql = " 
			WITH JobPos AS (
					SELECT	".$params['select_columns']."
							,ROW_NUMBER() OVER( ORDER BY sort ASC, ".$params['seq_column']." DESC  ) as rnum
					FROM	".$params['tbl_name']."
				) 
			SELECT  TOP 1 *
			FROM	JobPos
			WHERE	jb_seq = '".$params['jb_seq']."' ";
			break;

		case 92 :
			$sql = " WITH JobPos AS
				(
					SELECT	".$params['seq_column']." as jb_seq
						,ROW_NUMBER() OVER( ORDER BY sort ASC, ".$params['seq_column']." DESC  ) as rnum
					FROM	".$params['tbl_name']." 
				) 
				SELECT TOP 1 a.jb_seq
				FROM JobPos  a 
				WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc ";
			break;

		case 93 :
			$sql = " WITH JobPos AS
				(
					SELECT	".$params['seq_column']." as jb_seq
						,ROW_NUMBER() OVER( ORDER BY sort ASC, ".$params['seq_column']." DESC  ) as rnum
					FROM	".$params['tbl_name']." 
				) 
				SELECT TOP 1 a.jb_seq
				FROM JobPos  a 
				WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc ";
			break;

		case 94 :
			$sql = "
				INSERT INTO tb_jobpos
					(jpos_name,sort,use_yn,create_emp_seq,create_dt,jpos_code)
				SELECT	N'".$params['code_name']."','".$params['sort']."','".$params['useyn']."','".$params['login_emp_seq']."',getdate(),'".$params['job_gubun']."'+RIGHT('000'+CONVERT(varchar(3),CONVERT(int,ISNULL(max(replace(jpos_code,'".$params['job_gubun']."','')),0)+1)),3)
				FROM	tb_jobpos
			";
			break;

		case 95 :
			$sql = "
				INSERT INTO tb_jobduty
					(jduty_name,sort,use_yn,create_emp_seq,create_dt,jduty_code)
				SELECT			N'".$params['code_name']."','".$params['sort']."','".$params['useyn']."','".$params['login_emp_seq']."',getdate(),'".$params['job_gubun']."'+RIGHT('000'+CONVERT(varchar(3),CONVERT(int,ISNULL(max(replace(jduty_code,'".$params['job_gubun']."','')),0)+1)),3)
				FROM	tb_jobduty
			";
			break;

		case 96 :
			$sql = "
				INSERT INTO tb_jobgrade
					(jgrade_name,sort,use_yn,create_emp_seq,create_dt,jgrade_code)
				SELECT	N'".$params['code_name']."','".$params['sort']."','".$params['useyn']."','".$params['login_emp_seq']."',getdate(),'".$params['job_gubun']."'+RIGHT('000'+CONVERT(varchar(3),CONVERT(int,ISNULL(max(replace(jgrade_code,'".$params['job_gubun']."','')),0)+1)),3)
				FROM	tb_jobgrade
			";
			break;

		case 97 :
			$sql = "
				UPDATE tb_jobpos
				SET
					jpos_name = N'".$params['code_name']."'
					,sort = '".$params['sort']."'
					,use_yn='".$params['useyn']."'
					,modify_emp_seq = '".$params['login_emp_seq']."'
					,modify_dt = getdate()
				WHERE
					jpos_seq = '".$params['val_seq']."'
			";
			break;

		case 98 :
			$sql = "
				UPDATE tb_jobduty
				SET
					jduty_name = N'".$params['code_name']."'
					,sort = '".$params['sort']."'
					,use_yn='".$params['useyn']."'
					,modify_emp_seq = '".$params['login_emp_seq']."'
					,modify_dt = getdate()
				WHERE
					jduty_seq = '".$params['val_seq']."'
			";
			break;

		case 99 :
			$sql = "
				UPDATE tb_jobgrade
				SET
					jgrade_name = N'".$params['code_name']."'
					,sort = '".$params['sort']."'
					,use_yn='".$params['useyn']."'
					,modify_emp_seq = '".$params['login_emp_seq']."'
					,modify_dt = getdate()
				WHERE
					jgrade_seq = '".$params['val_seq']."'
			";
			break;

		case 100 :
			$sql = " DELETE FROM tb_jobpos WHERE jpos_seq= '".$params['val_seq']."'";
			break;

		case 101 :
			$sql = " DELETE FROM tb_jobduty WHERE jduty_seq= '".$params['val_seq']."'";
			break;

		case 102 :
			$sql = " DELETE FROM tb_jobgrade WHERE jgrade_seq= '".$params['val_seq']."'";
			break;

		

		case 111 :
			$sql = " 
				SELECT COUNT(*) AS CNT 
				FROM tb_login_log lg
					INNER JOIN tb_employee em ON lg.emp_seq = em.emp_seq
				WHERE ".getCheckOrgAuthQuery('lg.emp_seq')."
					AND admin_level > '' 
					".$params['search_sql']." ";
			break;

		case 112 :
			$sql = " WITH LoginLog AS
				(
					SELECT top ".$params['end']." login_seq, ip_addr,lg.LOGIN_YN,lg.LOGIN_FAIL_CNT,lg.LOGIN_LOCK_YN,lg.LOGIN_LOCK_TYPE, emp_name,emp_no, convert(varchar(19),login_dt,21) as login_dt,  convert(varchar(19),logout_dt,21) as logout_dt,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_login_log lg
						INNER JOIN tb_employee em ON lg.emp_seq = em.emp_seq
					WHERE ".getCheckOrgAuthQuery('lg.emp_seq')."
						AND admin_level > '' 
						".$params['search_sql']."
				) 
				SELECT * 
				FROM LoginLog 
				WHERE rnum > ".$params['start']." ";
			break;

		case 113 :
			$sql = "SELECT convert(varchar(19),login_dt,21) as login_dt,org_name,dept_name,ip_addr,email,phone_no,emp_name,emp_no
					,  convert(varchar(19),logout_dt,21) as logout_dt,lg.LOGIN_YN,lg.LOGIN_FAIL_CNT,lg.LOGIN_LOCK_YN,lg.LOGIN_LOCK_TYPE
				FROM tb_login_log lg
					INNER JOIN tb_employee em ON lg.emp_seq = em.emp_seq
					LEFT JOIN tb_organ org ON em.org_id = org.org_id
					LEFT JOIN tb_department dpt ON em.dept_seq = dpt.dept_seq
				WHERE ".getCheckOrgAuthQuery('lg.emp_seq')."
					AND admin_level > '' 
					".$params['search_sql']." 
					".$params['order_sql']." 
				";
			break;

		case 114 :
			$sql = " 
			SELECT COUNT(*) AS CNT 
			FROM tb_notice A
				LEFT JOIN tb_employee E ON isnull(A.modify_emp_seq,A.create_emp_seq) = E.emp_seq
			WHERE 1=1 ".$params['search_sql'];
			break;

		case 115 :
			$sql = " WITH Notice AS
				(
					SELECT top ".$params['end']." A.notice_seq, A.gubun, A.title, CONVERT(CHAR(16),A.create_dt,120) as write_date, E.emp_name,A.img_file_path,A.img_file_name,A.pds_file_name,A.pds_file_path,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_notice A
						LEFT JOIN tb_employee E ON A.create_emp_seq = E.emp_seq
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT * 
				FROM Notice 
				WHERE rnum > ".$params['start']." ";
			break;

		case 116 :
			$sql = " WITH Notice AS
			(
				SELECT N.notice_seq, N.title,N.contents,CONVERT(char(16),N.create_dt,120)  as write_date,N.gubun,N.img_file_real_name,N.img_file_name,N.img_file_path,N.pds_file_real_name,N.pds_file_name,N.pds_file_path,E.emp_name,
					ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
				FROM tb_notice N
					LEFT JOIN tb_employee E ON N.create_emp_seq = E.emp_seq
				WHERE 1 = 1 ".$params['search_sql']."
			) 
			SELECT * 
			FROM Notice 
			WHERE notice_seq = '".$params['notice_seq']."' ";
			break;

		case 117 :
			$sql = " WITH Notice AS
				(
					SELECT N.notice_seq,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_notice N
						INNER JOIN tb_employee E ON N.create_emp_seq = E.emp_seq
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT TOP 1 notice_seq 
				FROM Notice  
				 WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc  ";
			break;

		case 118 :
			$sql = " WITH Notice AS
				(
					SELECT N.notice_seq,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_notice N
						INNER JOIN tb_employee E ON N.create_emp_seq = E.emp_seq
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT TOP 1 notice_seq 
				FROM Notice  
				WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc  ";
			break;

		case 119 :
			$sql = " 
				SELECT   *
				FROM tb_notice 
				WHERE notice_seq = '".$params['notice_seq']."' ";
			break;

		case 120 :
			$sql  = "INSERT INTO tb_notice ( gubun, title, contents, create_dt,create_emp_seq,img_file_real_name,img_file_name,img_file_path,pds_file_real_name,pds_file_name,pds_file_path) 
						VALUES ('".$params['gubun']."', N'".$params['title']."', '".$params['contents']."', getdate(), '".$params['emp_seq']."', null,null,null, N'".$params['file_real_name']."', N'".$params['up_file']."', N'".$params['up_savedir']."') ";
			break;

		case 121 :
			$sql  = "UPDATE tb_notice  
				SET   TITLE= N'".$params['title']."'
						, CONTENTS = '".$params['contents']."'
						".$params['sql_upfile']."
						, modify_dt = getdate()
						, modify_emp_seq = '".$params['emp_seq']."'
				WHERE notice_seq  = '".$params['notice_seq']."' ";
			break;

		case 122 :
			$sql  = "DELETE FROM tb_notice WHERE notice_seq = '".$params['notice_seq']."' ";
			break;

		case 123 :
			$sql = " 
			SELECT COUNT(*) AS CNT 
			FROM tb_vaccine 
			WHERE 1=1 ".$params['search_sql']." ";
			break;

		case 124 :
			$sql = " WITH Vacc AS
				(
					SELECT top ".$params['end']." vacc_seq, vacc_name,vacc_ver,use_yn,sort,vacc_desc,gubun,process_name,link,CONVERT(char(10),create_dt,21) as create_dt,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_vaccine 
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT * 
				FROM Vacc 
				WHERE rnum > ".$params['start']." ";
			break;

		case 125 :
			$sql = " WITH Vacc AS
				(
					SELECT vacc_name,vacc_seq, vacc_ver,use_yn,sort,vacc_desc,gubun,process_name,link,CONVERT(char(16),create_dt,21) as create_dt,CONVERT(char(16),modify_dt,21) as modify_dt
						,(SELECT emp_name FROM tb_employee WHERE emp_seq = V.create_emp_seq) as create_emp
						,(SELECT emp_name FROM tb_employee WHERE emp_seq = V.modify_emp_seq) as modify_emp
						,ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_vaccine V
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT * 
				FROM Vacc 
				WHERE vacc_seq = '".$params['vacc_seq']."' ";
			break;

		case 126 :
			$sql = " WITH Vacc AS
			(
				SELECT vacc_seq,
					ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
				FROM tb_vaccine
				WHERE 1 = 1 ".$params['search_sql']."
			) 
			SELECT TOP 1 vacc_seq 
			FROM Vacc  
			 WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc  ";
			break;

		case 127 :
			$sql = " WITH Vacc AS
			(
				SELECT vacc_seq,
					ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
				FROM tb_vaccine
				WHERE 1 = 1 ".$params['search_sql']."
			) 
			SELECT TOP 1 vacc_seq 
			FROM Vacc  
			WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc  ";
			break;

		case 128 :
			$sql = "INSERT INTO tb_vaccine (com_id,vacc_name,vacc_ver,use_yn,sort,vacc_desc,gubun,process_name,link,create_emp_seq,create_dt)
	    		VALUES ( '".$params['com_id']."', N'".$params['v_name']."', N'".$params['v_ver']."','".$params['use_yn']."','".$params['sort']."', N'".$params['v_desc']."','".$params['gubun']."','".$params['p_name']."', N'".$params['link']."','".$params['emp_seq']."',getdate() ) ";
			break;

		case 129 :
			$sql = "
				UPDATE tb_vaccine 
				  SET       com_id='".$params['com_id']."'
							 , vacc_name= N'".$params['v_name']."'
							 , vacc_ver= N'".$params['v_ver']."'
							 , use_yn='".$params['use_yn']."'
							 , sort='".$params['sort']."'
							 , vacc_desc= N'".$params['v_desc']."'
							 , gubun='".$params['gubun']."'
							 , process_name='".$params['p_name']."'
							 , link = N'".$params['link']."'
							 , modify_emp_seq='".$params['emp_seq']."'
							 , modify_dt=getdate()
				  WHERE vacc_seq='".$params['v_seq']."' ";
			break;

		case 130 :
			$sql = "DELETE FROM tb_vaccine WHERE vacc_seq='".$params['v_seq']."' ";
			break;

		case 131 :
			$sql = " 
			SELECT COUNT(*) AS CNT 
			FROM tb_faq A
				LEFT JOIN tb_employee E ON isnull(A.modify_emp_seq,A.create_emp_seq) = E.emp_seq
			WHERE 1=1 ".$params['search_sql'];
			break;

		case 132 :
			$sql = " WITH Faq AS
				(
					SELECT top ".$params['end']." A.faq_seq, A.gubun, A.title, CONVERT(CHAR(16),A.create_dt,120) as write_date, E.emp_name,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_faq A
						LEFT JOIN tb_employee E ON A.create_emp_seq = E.emp_seq
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT * 
				FROM Faq 
				WHERE rnum > ".$params['start']." ";
			break;

		case 133 :
			$sql = " WITH Faq AS
			(
				SELECT N.faq_seq, N.title,N.contents,CONVERT(char(16),N.create_dt,120)  as write_date,N.gubun,E.emp_name,
					ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
				FROM tb_faq N
					LEFT JOIN tb_employee E ON N.create_emp_seq = E.emp_seq
				WHERE 1 = 1 ".$params['search_sql']."
			) 
			SELECT * 
			FROM Faq 
			WHERE faq_seq = '".$params['faq_seq']."' ";
			break;

		case 134 :
			$sql = " WITH Faq AS
				(
					SELECT N.faq_seq,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_faq N
						INNER JOIN tb_employee E ON N.create_emp_seq = E.emp_seq
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT TOP 1 faq_seq 
				FROM Faq  
				 WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc  ";
			break;

		case 135 :
			$sql = " WITH Faq AS
				(
					SELECT N.faq_seq,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_faq N
						INNER JOIN tb_employee E ON N.create_emp_seq = E.emp_seq
					WHERE 1 = 1 ".$params['search_sql']."
				) 
				SELECT TOP 1 faq_seq 
				FROM Faq  
				WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc  ";
			break;

		case 136 :
			$sql = " 
				SELECT   *
				FROM tb_faq 
				WHERE faq_seq = '".$params['faq_seq']."' ";
			break;

		case 137 :
			$sql  = "INSERT INTO tb_faq ( gubun, title, contents, create_dt,create_emp_seq) 
						VALUES ('".$params['gubun']."', N'".$params['title']."', '".$params['contents']."', getdate(), '".$params['emp_seq']."') ";
			break;

		case 138 :
			$sql  = "UPDATE tb_faq  
				SET   TITLE= N'".$params['title']."'
						, CONTENTS = '".$params['contents']."'
						, modify_dt = getdate()
						, modify_emp_seq = '".$params['emp_seq']."'
				WHERE faq_seq  = '".$params['faq_seq']."' ";
			break;

		case 139 :
			$sql  = "DELETE FROM tb_faq WHERE faq_seq = '".$params['faq_seq']."' ";
			break;

		case 140 :
			$sql = "SELECT	v_com_seq,v_com_name,v_ceo_name,v_com_code_1,v_com_code_2,v_com_code_3,v_com_gubun_1,v_com_gubun_2,use_yn
					FROM	tb_v_company
					ORDER BY v_com_name ";
			break;
		case 141 :
			$sql = "SELECT	v_com_seq,v_com_name,v_ceo_name,v_com_code_1,v_com_code_2,v_com_code_3,v_com_gubun_1,v_com_gubun_2,use_yn
					FROM	tb_v_company
					WHERE	v_com_seq = '".$params['com_seq']."' ";
			break;
		
		case 142 :
			$sql = "INSERT tb_v_company (
						v_com_name,v_ceo_name,v_com_code_1,v_com_code_2,v_com_code_3,v_com_gubun_1,v_com_gubun_2,use_yn,create_dt
					)VALUES(
						'".$params['com_name']."','".$params['ceo_name']."','".$params['com_code1']."','".$params['com_code2']."','".$params['com_code3']."','".$params['com_gubun1']."','".$params['com_gubun2']."','".$params['com_use_yn']."',getdate()
					)";
			break;

		case 143:
			$sql = "UPDATE tb_v_company 
					SET		v_com_name = N'".$params['com_name']."' 
							,v_ceo_name = N'".$params['ceo_name']."'
							,v_com_code_1 = '".$params['com_code1']."'
							,v_com_code_2 = '".$params['com_code2']."'
							,v_com_code_3 = '".$params['com_code3']."'
							,v_com_gubun_1 = N'".$params['com_gubun1']."'
							,v_com_gubun_2 = N'".$params['com_gubun2']."'
							,use_yn = '".$params['com_use_yn']."' 
					WHERE	v_com_seq = '".$params['com_seq']."' ";
			break;

		case 144 :
			$sql = "UPDATE tb_v_user 
					SET	v_user_name = '".$params['user_name_encrypt']."' 
						,v_email = '".$params['user_email_encrypt']."'
						,v_phone = '".$params['user_phone_encrypt']."'
						,use_yn = '".$params['user_use_yn']."'
						,v_com_seq = '".$params['com_seq']."'
					WHERE	v_user_seq = '".$params['v_user_seq']."' ";
			break;

		case 145 :
			$sql = "
				SELECT	code_key,code_name,code_seq
				FROM	tb_code
				WHERE	code_key = '".$params['code_key']."'
					AND p_code_seq > 0
				ORDER BY code_name,sort,code_seq ";
			break;

		case 146 :
			$sql = "SELECT COUNT(*) AS CNT 
					FROM	tb_v_wvcs_info vcs
							LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
							INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
							LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
							LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
							LEFT JOIN tb_organ org ON cn.org_id = org.org_id
						WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
							AND vcs.v_wvcs_seq = 
								(CASE WHEN v_asset_type='NOTEBOOK' THEN (
									SELECT TOP 1 v_wvcs_seq
									FROM	tb_v_wvcs_info vcs2
									WHERE	v_notebook_key = vcs.v_notebook_key
										and v_user_seq = vcs.v_user_seq
									ORDER BY v_wvcs_seq DESC)
								ELSE vcs.v_wvcs_seq END)
							".$params['search_sql'];
			break;
		
		case 147 :
			$sql = " WITH Result AS
					(
						SELECT	TOP ".$params['end']." vcs.v_wvcs_seq, vcd.v_wvcs_detail_seq,convert(varchar(16),vcs.wvcs_dt ,21) as	check_date,vcs.checkin_available_dt,vcd.v_manufacturer,
								vcs.wvcs_type,vcs.v_notebook_key,vcs.v_asset_type,vcd.v_sys_sn, vcd.v_hdd_sn, vcd.v_board_sn, vc.v_com_name,
								CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcd.os_ver_name,vcd.os_ver_major,vcd.os_ver_minor) ELSE
								os_ver_name END as os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,
								CONVERT(varchar(16),vcs.wvcs_authorize_dt,21) as in_date,cn.scan_center_name,org.org_name,vcs.vcs_status,vcs.vacc_scan_count,
								CONVERT(varchar(16),vcs.checkout_dt,21) as out_date,
								us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript,
								ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM	tb_v_wvcs_info vcs
							LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
							INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
							LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
							LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
							LEFT JOIN tb_organ org ON cn.org_id = org.org_id
						WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
							AND vcs.v_wvcs_seq = 
								(CASE WHEN v_asset_type='NOTEBOOK' THEN (
									SELECT TOP 1 v_wvcs_seq
									FROM	tb_v_wvcs_info vcs2
									WHERE	v_notebook_key = vcs.v_notebook_key
										and v_user_seq = vcs.v_user_seq
									ORDER BY v_wvcs_seq DESC)
								ELSE vcs.v_wvcs_seq END)
							".$params['search_sql']."
					) 
					SELECT a.*,
						(	SELECT count(*) 
							FROM tb_v_wvcs_info_file 
							WHERE a.v_wvcs_seq = v_wvcs_seq
								AND file_scan_result='BAD_EXT') as file_bad_cnt,
						(	SELECT count(*) 
							FROM tb_v_wvcs_weakness 
							WHERE a.v_wvcs_seq = v_wvcs_seq
								AND org_status='WEAK') as weak_cnt,
						(	SELECT count(distinct vccd.virus_path) 
							FROM tb_v_wvcs_vaccine vcc
								INNER JOIN tb_v_wvcs_vaccine_detail  vccd
								ON  vcc.vaccine_seq = vccd.vaccine_seq
							WHERE a.v_wvcs_seq = v_wvcs_seq) as virus_cnt,
						(	(SELECT count(pd_seq) 
							FROM tb_v_wvcs_pdisk
							WHERE a.v_wvcs_seq = v_wvcs_seq)
							--+	(SELECT count(ld_seq)
							--FROM tb_v_wvcs_ldisk
							--WHERE a.v_wvcs_seq = v_wvcs_seq
							--	AND drive_type='CD/DVD')
							) as disk_cnt,
						(	SELECT count(v_wvcs_file_seq) 
							FROM tb_v_wvcs_info_file f1
							WHERE a.v_wvcs_detail_seq = v_wvcs_detail_seq
									and a.v_wvcs_seq = v_wvcs_seq) as scan_file_cnt,
						(	SELECT count(v_wvcs_file_in_seq) 
							FROM tb_v_wvcs_info_file_in f1
							WHERE a.v_wvcs_detail_seq = f1.v_wvcs_detail_seq
									and a.v_wvcs_seq = f1.v_wvcs_seq) as import_file_cnt
					FROM Result a
					WHERE rnum > ".$params['start']." ";
							
			break;

		case 150 :
			$sql = " WITH Vcs AS
				(
					SELECT	 vcs.v_wvcs_seq, convert(varchar(19),vcs.wvcs_dt ,21) as check_date,checkin_available_dt,vcd.v_sys_sn,vcd.v_hdd_sn,vcd.v_board_sn,mac_addr,vcs.memo_text,vc.v_com_name,v_notebook_key,
							wvcs_type,v_asset_type,os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,v_model_name,v_manufacturer,CONVERT(varchar(19), wvcs_authorize_dt,21) as  wvcs_authorize_dt, wvcs_authorize_name,ROW_NUMBER() OVER(".$params['order_sql'].") as rnum,cn.scan_center_name,cn.scan_center_code,vcs.ip_addr,org.org_name,vcs.vcs_status,CONVERT(varchar(19), checkout_dt,21) as  checkout_dt, vcs.barcode,
							vcs.vacc_scan_count, vcs.file_send_status, vcs.file_delete_flag,vcs.file_send_date,vcd.make_winpe
						,us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript
						,vi.v_user_belong,vi.v_purpose, vcd.copy_device_instance_path,vii.label_value
						,vcd.device_in_flag,
						(SELECT TOP 1 CONVERT(varchar(19),wvcs_dt,21)
						FROM	tb_v_wvcs_info v2
						WHERE	vcs.v_notebook_key = v2.v_notebook_key
							and vcs.v_user_seq = v2.v_user_seq
						ORDER BY v2.v_wvcs_seq DESC) as last_check_date,
						(	(SELECT count(pd_seq) 
							FROM tb_v_wvcs_pdisk
							WHERE vcs.v_wvcs_seq = v_wvcs_seq) 	
							--+(SELECT count(ld_seq)
							--FROM tb_v_wvcs_ldisk
							--WHERE vcs.v_wvcs_seq = v_wvcs_seq
							--	AND drive_type='CD/DVD')
						) as disk_cnt,
						(	SELECT count(v_wvcs_file_seq) 
							FROM tb_v_wvcs_info_file f1
							WHERE vcd.v_wvcs_detail_seq = v_wvcs_detail_seq
									and vcs.v_wvcs_seq = v_wvcs_seq) as scan_file_cnt,
						(	SELECT count(v_wvcs_file_in_seq) 
							FROM tb_v_wvcs_info_file_in f1
							WHERE vcd.v_wvcs_detail_seq = f1.v_wvcs_detail_seq
									and vcs.v_wvcs_seq = f1.v_wvcs_seq) as import_file_cnt
					FROM	tb_v_wvcs_info vcs
						LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
						INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
						LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						LEFT JOIN tb_organ org ON org.org_id = cn.org_id
						LEFT JOIN tb_v_user_list vi on vcs.v_user_list_seq = vi.v_user_list_seq
						LEFT JOIN tb_v_user_list_info vii on vi.v_user_list_seq = vii.v_user_list_seq
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code').
						$params['search_sql']."
				) 
				SELECT v.*
				FROM Vcs v
				WHERE v.v_wvcs_seq = '".$params['v_wvcs_seq']."' ";
			break;

		case 151 :
			$sql = " 
				WITH Vcs AS
					(
						SELECT vcs.v_wvcs_seq,vcs.v_asset_type,
							ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM	tb_v_wvcs_info vcs
							LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
							INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
							LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
							LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code').
							$params['search_sql']."
					) 
					SELECT TOP 1 a.v_wvcs_seq,v_asset_type
					FROM Vcs  a  
					WHERE rnum > '".$params['rnum']."' ORDER BY rnum asc ";
			break;
		
		case 152 :
			$sql = " 
				WITH Vcs AS
					(
						SELECT vcs.v_wvcs_seq,vcs.v_asset_type,
							ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM	tb_v_wvcs_info vcs
							LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
							INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
							LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
							LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code').
							$params['search_sql']."
					) 
					SELECT TOP 1 a.v_wvcs_seq,v_asset_type
					FROM Vcs  a  
					WHERE rnum < '".$params['rnum']."' ORDER BY rnum desc ";
			break;
		
		case 153 :
			$sql = "
				UPDATE tb_v_wvcs_info
				SET	
					mngr_name  = N'".$params['mngr_name']."'
					,mngr_department  = N'".$params['mngr_dept']."'
					,scan_center_code  = '".$params['scan_center_code']."'
					,memo_text  = N'".$params['memo']."'
				WHERE v_wvcs_seq = '".$params['v_wvcs_seq']."'
			";
			break;

		case 154 :
			$sql = "
				SELECT *
				FROM	tb_v_wvcs_info
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;

		case 155 :
			$sql = "
				SELECT	w1.v_asset_type,w1.v_notebook_key,w2.*
				FROM	tb_v_wvcs_info w1
					LEFT JOIN tb_v_wvcs_info_detail w2 ON w1.v_wvcs_seq = w2.v_wvcs_seq
				WHERE	w1.v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;
		
		case 156 :
			$sql = "
				SELECT	lk.*,vcs1.v_asset_type,vcs2.windows_dir
				FROM	tb_v_wvcs_ldisk lk
					inner join tb_v_wvcs_info vcs1 
						ON lk.v_wvcs_seq = vcs1.v_wvcs_seq
					left join tb_v_wvcs_info_detail vcs2
						ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
				WHERE	lk.v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;

		case 157 :
			$sql = "
				SELECT *
				FROM	tb_v_wvcs_pdisk
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;

		case 158 :
			$sql = "
				SELECT *
				FROM	tb_v_wvcs_macaddr
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;
		
		case 159 :
			$sql = "
				SELECT *
				FROM	tb_v_wvcs_programs
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;
		
		case 160 :
			$sql = "
				SELECT	COUNT(*) as weakness_cnt
				FROM	tb_v_wvcs_weakness
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']." '
					AND org_status='WEAK'
			";
			break;

		case 161 :
			$sql = "
				SELECT	COUNT(distinct vaccd.virus_path) as virus_cnt
				FROM tb_v_wvcs_vaccine vacc
					INNER JOIN tb_v_wvcs_vaccine_detail vaccd
						ON vacc.vaccine_seq = vaccd.vaccine_seq
				WHERE	vacc.v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;
		case 162 :
			$sql ="
				SELECT *
				FROM	tb_v_wvcs_weakness wk
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;

		case 163 :
			$sql = "
				SELECT	*
				FROM	tb_v_wvcs_vaccine 
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;
		
		case 164 :
			$sql = "
				SELECT  vcc2.*, ldk.drive_type
				FROM	tb_v_wvcs_vaccine vcc1
					INNER JOIN tb_v_wvcs_vaccine_detail vcc2 ON vcc1.vaccine_seq = vcc2.vaccine_seq
					LEFT JOIN tb_v_wvcs_ldisk ldk ON vcc1.v_wvcs_seq = ldk.v_wvcs_seq AND vcc2.vol_letter = ldk.vol_letter
				WHERE	vcc1.vaccine_seq = '".$params['vaccine_seq']."'
			";
			break;

		case 165 :
			$sql = "
				SELECT	*
				FROM	tb_v_wvcs_windowsupdate 
				WHERE	v_wvcs_seq ='".$params['v_wvcs_seq']."'
			";
			break;
		
		case 166 :
			$sql = "
				SELECT *
				FROM	tb_v_wvcs_windowsupdate_detail
				WHERE	windowsupdate_seq = '".$params['windowsupdate_seq']."'
			";
			break;
		
		case 167 :
			$sql = "SELECT COUNT(*) AS CNT 
					FROM	tb_v_wvcs_info vcs
							LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
							INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
							LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
							LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
							LEFT JOIN tb_organ org ON cn.org_id = org.org_id
						WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
							".$params['search_sql'];
			break;
		
		case 168 :
			$sql = " WITH Result AS
					(
						SELECT	TOP ".$params['end']." vcs.v_wvcs_seq, vcd.v_wvcs_detail_seq,convert(varchar(16),wvcs_dt ,21) as	check_date,checkin_available_dt,v_manufacturer,
								wvcs_type,v_asset_type,v_notebook_key,v_sys_sn,CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcd.os_ver_name,vcd.os_ver_major,vcd.os_ver_minor) ELSE
								os_ver_name END as os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,
								CONVERT(varchar(16),vcs.wvcs_authorize_dt,21) as in_date, vc.v_com_name,cn.scan_center_name,org.org_name,vcs.vcs_status,vcs.vacc_scan_count,
								CONVERT(varchar(16),vcs.checkout_dt,21) as out_date,
								us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript,
								ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM	tb_v_wvcs_info vcs
							LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
							INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
							LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
							LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
							LEFT JOIN tb_organ org ON cn.org_id = org.org_id
						WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
							".$params['search_sql']."
					) 
					SELECT a.*,
								(	SELECT count(*) 
									FROM tb_v_wvcs_info_file
									WHERE a.v_wvcs_seq = v_wvcs_seq
										AND file_scan_result='BAD_EXT') as file_bad_cnt,
								(	SELECT count(*) 
									FROM tb_v_wvcs_weakness 
									WHERE a.v_wvcs_seq = v_wvcs_seq
										AND org_status='WEAK') as weak_cnt,
								(	SELECT count(distinct vccd.virus_path) 
									FROM tb_v_wvcs_vaccine vcc
										INNER JOIN tb_v_wvcs_vaccine_detail  vccd
										ON  vcc.vaccine_seq = vccd.vaccine_seq
									WHERE a.v_wvcs_seq = v_wvcs_seq) as virus_cnt,
								(	(SELECT count(pd_seq) 
									FROM tb_v_wvcs_pdisk
									WHERE a.v_wvcs_seq = v_wvcs_seq)	
									--+(SELECT count(ld_seq)
									--FROM tb_v_wvcs_ldisk
									--WHERE a.v_wvcs_seq = v_wvcs_seq
									--	AND drive_type='CD/DVD') 
								) as disk_cnt,
								(	SELECT count(v_wvcs_file_seq) 
									FROM tb_v_wvcs_info_file f1
									WHERE a.v_wvcs_detail_seq = v_wvcs_detail_seq
											and a.v_wvcs_seq = v_wvcs_seq) as scan_file_cnt,
								(	SELECT count(v_wvcs_file_in_seq) 
									FROM tb_v_wvcs_info_file_in f1
									WHERE a.v_wvcs_detail_seq = f1.v_wvcs_detail_seq
											and a.v_wvcs_seq = f1.v_wvcs_seq) as import_file_cnt
					FROM Result a
					WHERE rnum > ".$params['start']." ";
							
			break;
		
		
		case 175 :
			$sql = "
				SELECT count(v_wvcs_seq) as check_cnt,count(weak_check) as weak_cnt, count(virus_check) as virus_cnt
				FROM 
					(SELECT v_wvcs_seq,
						(	SELECT TOP 1 v_wvcs_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq  AND org_status='WEAK') as weak_check,
						(	SELECT TOP 1 vcc.vaccine_seq 
							FROM tb_v_wvcs_vaccine vcc 
								INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
							WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
					FROM tb_v_wvcs_info vcs
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						AND vcs.v_asset_type='NOTEBOOK'
						AND wvcs_dt between '".$params['start_date']."' and '".$params['end_date']."' ) T
		
			";
			break;
		
		case 176 :
			$sql = "
				SELECT count(v_wvcs_seq) as check_cnt,count(virus_check) as virus_cnt
				FROM 
					(SELECT v_wvcs_seq,
						(	SELECT TOP 1 v_wvcs_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_check,
						(	SELECT TOP 1 vcc.vaccine_seq 
							FROM tb_v_wvcs_vaccine vcc 
								INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
							WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
					FROM tb_v_wvcs_info vcs
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						AND vcs.v_asset_type = 'RemovableDevice'
						AND wvcs_dt between '".$params['start_date']."' and '".$params['end_date']."' ) T
		
			";
			break;

		case 177 :
			$sql = "
				SELECT org_name,gubun,count(seq) as check_cnt,count(weak_check) as weak_cnt, count(virus_check) as virus_cnt
				FROM	(
					SELECT v_asset_type as  gubun,org.org_name,v_wvcs_seq as seq,
						(	SELECT TOP 1 v_wvcs_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_check,
						(	SELECT TOP 1 vcc.vaccine_seq 
							FROM tb_v_wvcs_vaccine vcc 
								INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
							WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
					FROM tb_v_wvcs_info vcs
						INNER JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						INNER JOIN tb_organ org ON org.org_id = cn.org_id
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						AND wvcs_dt between '".$params['sdate']."' and '".$params['edate']."') T
				GROUP BY org_name,gubun
				ORDER BY org_name,gubun
			";
			break;

		case 178 :
			$sql = "
				SELECT 
					base_date as label,
					COUNT(CASE WHEN convert(char(10),vcs.wvcs_dt,21)=base_date  THEN 1 end) check_cnt,
					COUNT(CASE WHEN convert(char(10),vcs.wvcs_dt,21)=base_date and  weak_check > ''  THEN 1 end) weak_cnt,
					COUNT(CASE WHEN convert(char(10),vcs.wvcs_dt,21)=base_date and  virus_check > ''  THEN 1 end) virus_cnt
				FROM (
					SELECT value as base_date 
					FROM dbo.fn_split( '".$params['str_date']."',',') ) dt  LEFT JOIN
					(SELECT 
							v_wvcs_seq,wvcs_success_yn,wvcs_dt,
							(	SELECT TOP 1 weakness_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_check,
							(	SELECT TOP 1 vcc.vaccine_seq 
								FROM tb_v_wvcs_vaccine vcc 
									INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
								WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
					FROM tb_v_wvcs_info vcs
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						AND wvcs_dt between '".$params['sdate']."' and '".$params['edate']."'  
						".$params['search_sql']." ) vcs ON dt.base_date = convert(char(10),vcs.wvcs_dt,21)
						
				GROUP BY base_date
				ORDER BY base_date
			";
			break;
		
		case 179 :
			$sql = "
				SELECT 
					base_month as label,
					COUNT(CASE WHEN convert(char(7),vcs.wvcs_dt,21)=base_month  THEN 1 end) check_cnt,
					COUNT(CASE WHEN convert(char(7),vcs.wvcs_dt,21)=base_month and weak_check > ''  THEN 1 end) weak_cnt,
					COUNT(CASE WHEN convert(char(7),vcs.wvcs_dt,21)=base_month and virus_check > ''  THEN 1 end) virus_cnt
				FROM (
					select value as base_month 
					from fn_split('".$params['str_ym']."',',') ) dt LEFT JOIN
					(SELECT 
							v_wvcs_seq,wvcs_success_yn,wvcs_dt,
							(	SELECT TOP 1 weakness_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK' ) as weak_check,
							(	SELECT TOP 1 vcc.vaccine_seq 
								FROM tb_v_wvcs_vaccine vcc 
									INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
								WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
					FROM tb_v_wvcs_info vcs
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						AND wvcs_dt between '".$params['sdate']."' and '".$params['edate']."' 
						".$params['search_sql']." ) vcs  ON dt.base_month = convert(char(7),vcs.wvcs_dt,21)
						
				GROUP BY base_month
				ORDER BY base_month
			";
			break;
		
		case 180 :
			$sql = "
				SELECT org.org_name,COUNT(v_wvcs_seq) as cnt
				FROM tb_v_wvcs_info vcs
					INNER JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					INNER JOIN tb_organ org ON cn.org_id = org.org_id
				WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')
					.$params['search_sql']."
				GROUP BY org.org_name
				ORDER BY cnt
			";
			break;
		
		case 181 :
			$sql = "
				SELECT mngr_department,COUNT(v_wvcs_seq) as cnt
				FROM tb_v_wvcs_info vcs
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')
					.$params['search_sql']."
					AND vcs.mngr_department > ''
				GROUP BY vcs.mngr_department
				ORDER BY cnt
			";
			break;
		
		case 182 :
			$sql = "
				SELECT weakness_name,COUNT(*) as cnt
				FROM	tb_v_wvcs_info vcs
					INNER JOIN  tb_v_wvcs_weakness wk
						ON vcs.v_wvcs_seq = wk.v_wvcs_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')
					.$params['search_sql']."
					AND wk.weakness_name > ''
					AND org_status='WEAK'
				GROUP BY weakness_name
				ORDER BY cnt
			";
			break;

		case 183 :
			$sql = "
				SELECT MAX(virus_name) virus_name,COUNT(*) as cnt
				FROM	tb_v_wvcs_info vcs
					INNER JOIN  tb_v_wvcs_vaccine vcc
						ON vcs.v_wvcs_seq = vcc.v_wvcs_seq
					INNER JOIN tb_v_wvcs_vaccine_detail vccd
						ON vcc.vaccine_seq = vccd.vaccine_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')
					.$params['search_sql']."
					AND vccd.virus_name > ''
				GROUP BY vccd.virus_name
				ORDER BY cnt
			";
			break;

		
		case 190 :
			$sql ="
				SELECT os_name,count(*) as cnt
				FROM (
					SELECT dbo.fn_os_name(os_ver_name,os_ver_major,os_ver_minor) as os_name
					FROM	tb_v_wvcs_info vcs
						LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						AND vcs.v_asset_type='NOTEBOOK'
						AND vcs.v_wvcs_seq = (
							SELECT TOP 1 v_wvcs_seq
							FROM	tb_v_wvcs_info vcs2
							WHERE	v_notebook_key = vcs.v_notebook_key
								and v_user_seq = vcs.v_user_seq
							ORDER BY v_wvcs_seq DESC ) ) T
				WHERE os_name > ''
				GROUP BY os_name
				ORDER BY cnt
			";
			break;

		
		case 191 :
			$sql ="
				SELECT v_manufacturer,count(*) as cnt	
				FROM	tb_v_wvcs_info vcs
					LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
					AND vcs.v_asset_type='NOTEBOOK'
					AND vcs.v_wvcs_seq = (
						SELECT TOP 1 v_wvcs_seq
						FROM	tb_v_wvcs_info vcs2
						WHERE	v_notebook_key = vcs.v_notebook_key
							and v_user_seq = vcs.v_user_seq
						ORDER BY v_wvcs_seq DESC )
					AND vcd.v_manufacturer > ''
				GROUP BY v_manufacturer
				ORDER BY CNT
			";
			break;
		
		case 192 :
			$sql = "
				UPDATE tb_v_wvcs_info
				SET	
					 wvcs_authorize_yn  = '".$params['wvcs_authorize_yn']."'
					,wvcs_authorize_dt  = ".$params['wvcs_authorize_dt']."
					,wvcs_authorize_name  = '".$params['wvcs_authorize_name_encrypt']."'
					,checkout_dt = NULL
					,vcs_status = '".$params['vcs_status']."'
				WHERE v_wvcs_seq = '".$params['v_wvcs_seq']."'
			";
			break;

		
		
		case 194 :
			$sql = "
				SELECT	org.org_id,org.org_name
				FROM	tb_admin_org_info ad
					INNER JOIN tb_organ org ON ad.org_id = org.org_id
						AND org.use_yn='Y'
				WHERE	ad.admin_seq = '".$params['emp_seq']."'
			";
			break;

		case 195 :
			$sql = " INSERT INTO tb_admin_org_info (admin_seq,org_id,create_emp_seq,create_dt)
					SELECT '".$params['emp_seq']."',value,'".$params['login_emp_seq']."',getdate()
					FROM	dbo.fn_split('".$params['strMngOrg']."',',') ";
			break;

		case 196 :
			$sql = "DELETE FROM tb_admin_org_info WHERE admin_seq = '".$params['emp_seq']."'  ";
			break;

		case 197 :
			$sql = " SELECT	vcs.v_wvcs_seq, convert(varchar(16),vcs.wvcs_dt ,21) as	check_date,vcs.checkin_available_dt,vcd.v_manufacturer,vcs.vacc_scan_count,
							vcs.wvcs_type,vcs.v_notebook_key,vcs.v_asset_type,vcd.v_sys_sn, vcd.v_hdd_sn, vcd.v_board_sn, vc.v_com_name,
							CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcd.os_ver_name,vcd.os_ver_major,vcd.os_ver_minor) ELSE
							os_ver_name END as os_ver_name
							,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,vcs.wvcs_authorize_name,
							CONVERT(varchar(16),vcs.wvcs_authorize_dt,21) as in_date,CONVERT(varchar(16),vcs.checkout_dt,21) as out_date, vcs.vcs_status,
							us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript,
							(	SELECT count(*) 
								FROM tb_v_wvcs_info_file 
								WHERE vcs.v_wvcs_seq = v_wvcs_seq
									AND file_scan_result='BAD_EXT') as file_bad_cnt,
							(	SELECT count(*) 
								FROM tb_v_wvcs_weakness 
								WHERE vcs.v_wvcs_seq = v_wvcs_seq
									AND org_status='WEAK') as weak_cnt,
							(	SELECT count(distinct vccd.virus_path) 
								FROM tb_v_wvcs_vaccine vcc
									INNER JOIN tb_v_wvcs_vaccine_detail  vccd
									ON  vcc.vaccine_seq = vccd.vaccine_seq
								WHERE vcs.v_wvcs_seq = v_wvcs_seq) as virus_cnt,
							(	(SELECT count(pd_seq) 
								FROM tb_v_wvcs_pdisk
								WHERE vcs.v_wvcs_seq = v_wvcs_seq)	
								--+(SELECT count(ld_seq)
								--FROM tb_v_wvcs_ldisk
								--WHERE vcs.v_wvcs_seq = v_wvcs_seq
								--	AND drive_type='CD/DVD')
								) as disk_cnt,
							
								(	SELECT count(v_wvcs_file_seq) 
									FROM tb_v_wvcs_info_file f1
									WHERE vcd.v_wvcs_detail_seq = v_wvcs_detail_seq
										and vcs.v_wvcs_seq = v_wvcs_seq) as scan_file_cnt,
							(	SELECT count(v_wvcs_file_in_seq) 
							FROM tb_v_wvcs_info_file_in f1
							WHERE vcd.v_wvcs_detail_seq = f1.v_wvcs_detail_seq
									and vcs.v_wvcs_seq = f1.v_wvcs_seq) as import_file_cnt,
							cn.scan_center_name,org.org_name
					FROM	tb_v_wvcs_info vcs
						LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
						INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
						LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						LEFT JOIN tb_organ org ON cn.org_id = org.org_id
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						AND vcs.v_wvcs_seq = 
							(CASE WHEN v_asset_type='NOTEBOOK' THEN (
								SELECT TOP 1 v_wvcs_seq
								FROM	tb_v_wvcs_info vcs2
								WHERE	v_notebook_key = vcs.v_notebook_key
									and v_user_seq = vcs.v_user_seq
								ORDER BY v_wvcs_seq DESC)
							ELSE vcs.v_wvcs_seq END)
						".$params['search_sql']."
						".$params['order_sql'];
							
			break;

		case 198 :
			$sql = " SELECT	vcs.v_wvcs_seq, convert(varchar(16),wvcs_dt ,21) as	check_date,checkin_available_dt,v_manufacturer,vcs.vacc_scan_count,
							wvcs_type,v_asset_type,v_notebook_key,v_sys_sn,
							CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcd.os_ver_name,vcd.os_ver_major,vcd.os_ver_minor) ELSE
								os_ver_name END as os_ver_name
							,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,vcs.wvcs_authorize_name,
							CONVERT(varchar(16),vcs.wvcs_authorize_dt,21) as in_date,CONVERT(varchar(16),vcs.checkout_dt,21) as out_date, vc.v_com_name, vcs.vcs_status,
							us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript,
							
							(	SELECT count(*) 
								FROM tb_v_wvcs_info_file 
								WHERE vcs.v_wvcs_seq = v_wvcs_seq
									AND file_scan_result='BAD_EXT') as file_bad_cnt,
							(	SELECT count(*) 
								FROM tb_v_wvcs_weakness 
								WHERE vcs.v_wvcs_seq = v_wvcs_seq
									AND org_status='WEAK') as weak_cnt,
							(	SELECT count(distinct vccd.virus_path) 
								FROM tb_v_wvcs_vaccine vcc
									INNER JOIN tb_v_wvcs_vaccine_detail  vccd
									ON  vcc.vaccine_seq = vccd.vaccine_seq
								WHERE vcs.v_wvcs_seq = v_wvcs_seq) as virus_cnt,
							(	(SELECT count(pd_seq) 
								FROM tb_v_wvcs_pdisk
								WHERE vcs.v_wvcs_seq = v_wvcs_seq)	
								--+(SELECT count(ld_seq)
								--FROM tb_v_wvcs_ldisk
								--WHERE vcs.v_wvcs_seq = v_wvcs_seq
								--	AND drive_type='CD/DVD')
								) as disk_cnt,
								(	SELECT count(v_wvcs_file_seq) 
									FROM tb_v_wvcs_info_file f1
									WHERE vcd.v_wvcs_detail_seq = v_wvcs_detail_seq
										and vcs.v_wvcs_seq = v_wvcs_seq) as scan_file_cnt,
							(	SELECT count(v_wvcs_file_in_seq) 
							FROM tb_v_wvcs_info_file_in f1
							WHERE vcd.v_wvcs_detail_seq = f1.v_wvcs_detail_seq
									and vcs.v_wvcs_seq = f1.v_wvcs_seq) as import_file_cnt,
							cn.scan_center_name,org.org_name
					FROM	tb_v_wvcs_info vcs
						LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
						INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
						LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						LEFT JOIN tb_organ org ON cn.org_id = org.org_id
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						".$params['search_sql']."
						".$params['order_sql'];
							
			break;
		case 199 :
			$sql = "
					SELECT *
					FROM	tb_weakness
				";
			break;

		case 200 :
			$sql = "
				UPDATE tb_weakness
				SET	use_yn=(CASE WHEN weakness_seq in (".$params['use_wk_seq']." ) THEN 'Y' ELSE 'N' END)
			";
			break;
		
		case 201 :
			$sql = "
				INSERT INTO ".$params['sms_table']." (
					CUR_STATE, CALL_TO, CALL_FROM, SMS_TXT, MSG_TYPE
				) VALUES (
					0,'".$params['receiver']."', '".$params['sender']."', '".$params['send_msg']."', 4
				);";
			break;

		case 202 :
			$sql = "
				INSERT INTO tb_admin_otp_log (
					admin_seq,otp_code,check_count,create_dt
				) values(
					'".$params['admin_seq']."','".$params['otp_code']."', 0, Getdate()
				)
			";
			break;
		
		case 203 :
			$sql = "
				SELECT	TOP 1 otp_code,admin_otp_log_seq,check_count
				FROM	tb_admin_otp_log
				WHERE	admin_seq = (SELECT emp_seq FROM tb_employee WHERE work_yn='Y' AND emp_no = '".$params['login_id']."')
				ORDER BY admin_otp_log_seq DESC
			";
			break;

		case 204 :
			$sql = "
				UPDATE	tb_admin_otp_log
				SET		check_count = check_count + 1
				WHERE	admin_otp_log_seq = '".$params['admin_otp_log_seq']."'
			";
			break;

		case 205 :
			$sql = "
				UPDATE	tb_admin_otp_log
				SET		update_dt = getdate()
				WHERE	admin_otp_log_seq = '".$params['admin_otp_log_seq']."'
			";
			break;
		
		case 206 :
			$sql = "
				SELECT count(*) as cnt
				FROM tb_scan_center a
					LEFT JOIN tb_organ o ON a.org_id = o.org_id
				WHERE ".getCheckOrgAuthQuery('o.org_id')."
					".$params['search_sql']." ";
			break;

		case 207 :
			$sql = " 
				WITH Center AS
					(
						SELECT top ".$params['end']." 
							a.scan_center_seq,a.scan_center_code,a.scan_center_name,a.sort,a.use_yn,o.org_id,o.org_name,a.scan_center_div
							,(select count(kiosk_seq) from tb_scan_center_kiosk where scan_center_code = a.scan_center_code) as kiosk_cnt
							,ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM tb_scan_center a
							LEFT JOIN tb_organ o ON a.org_id = o.org_id
						WHERE ".getCheckOrgAuthQuery('o.org_id')."
							".$params['search_sql']."
					) 
					SELECT a.*
					FROM Center  a	
					WHERE rnum > ".$params['start']." ";
			break;
		
		case 208:
			$sql = "
				 WITH Center AS (					
				SELECT  cn.scan_center_seq,cn.scan_center_code,cn.scan_center_name,cn.use_yn,cn.sort,cn.org_id,cn.scan_center_div
					,ROW_NUMBER() OVER(".$params['order_sql']." ) as rnum
				FROM	tb_scan_center cn
					LEFT JOIN tb_organ o ON cn.org_id = o.org_id
				WHERE ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) SELECT *
				  FROM Center 
				  WHERE scan_center_seq= '".$params['scan_center_seq']."'";
			break;
		
		case 209 :
			$sql = " 
				WITH Center AS (
					SELECT	 scan_center_seq
							,ROW_NUMBER() OVER( ".$params['order_sql']."  ) as rnum
					FROM	tb_scan_center cn
						LEFT JOIN tb_organ o ON cn.org_id = o.org_id
					WHERE	 ".getCheckOrgAuthQuery('o.org_id')." ".$params['search_sql']."
				) 
				SELECT  TOP 1 *
				FROM	Center 
				WHERE   1 = 1 ".$params['prev_next_sql'];
			break;

		case 210 :
			$sql = "
				INSERT INTO tb_scan_center(org_id,scan_center_code,scan_center_name,use_yn,sort,create_dt,scan_center_div) VALUES (
					'".$params['org_id']."','".$params['scan_center_code']."', N'".$params['scan_center_name']."','".$params['use_yn']."','".$params['sort']."',getdate(),'".$params['scan_center_div']."'
				);
			";
			break;

		case 211 :
			$sql = "
				UPDATE tb_scan_center
				SET	
					org_id = '".$params['org_id']."',
					scan_center_name = N'".$params['scan_center_name']."',
					use_yn = '".$params['use_yn']."',
					sort = '".$params['sort']."',
					scan_center_div = '".$params['scan_center_div']."'
				WHERE
					scan_center_seq =  '".$params['scan_center_seq']."'
			";
			break;
		
		case 212 :
			$sql ="
				DELETE FROM tb_scan_center WHERE scan_center_seq =  '".$params['scan_center_seq']."'
			";
			break;
		
		case 213 :
			$sql = "
				SELECT *
				FROM	tb_scan_center
				WHERE	1 = 1 ".$params['search_sql'];
			break;
		
		case 214 :
			$sql = "
				SELECT	cn.scan_center_code,cn.scan_center_name
				FROM	tb_admin_scan_center_info sc
					INNER JOIN tb_scan_center cn ON sc.scan_center_code = cn.scan_center_code
						AND cn.use_yn='Y'
				WHERE	sc.admin_seq = '".$params['emp_seq']."'
			";
			break;

		case 215 :
			$sql = " INSERT INTO tb_admin_scan_center_info (admin_seq,scan_center_code,create_emp_seq,create_dt)
					SELECT '".$params['emp_seq']."',value,'".$params['login_emp_seq']."',getdate()
					FROM	dbo.fn_split('".$params['strMngScanCenter']."',',') ";
			break;

		case 216 :
			$sql = "DELETE FROM tb_admin_scan_center_info WHERE admin_seq = '".$params['emp_seq']."'  ";
			break;

		case 217 :
			$sql = " 
				SELECT	 vcs.v_wvcs_seq, convert(varchar(19),vcs.wvcs_dt ,21) as		check_date,checkin_available_dt,vcd.v_sys_sn,vcd.v_hdd_sn,vcd.v_board_sn,mac_addr,vcs.memo_text,vc.v_com_name,v_notebook_key,
						wvcs_type,org.org_name,v_asset_type,os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,v_model_name,v_manufacturer,CONVERT(varchar(19), wvcs_authorize_dt,21) as  wvcs_authorize_dt, wvcs_authorize_name,cn.scan_center_name,cn.scan_center_code,
						(SELECT TOP 1 CONVERT(varchar(19),wvcs_dt,21)
						FROM	tb_v_wvcs_info v2
						WHERE	v_notebook_key = v2.v_notebook_key
							and v_user_seq = v2.v_user_seq
						ORDER BY v2.v_wvcs_seq DESC) as last_check_date
				FROM	tb_v_wvcs_info vcs
					LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
					INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
					LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					LEFT JOIN tb_organ org ON cn.org_id = org.org_id
				WHERE vcs.v_wvcs_seq = '".$params['v_wvcs_seq']."' ";
			break;
		
		case 218 :
			$sql = "
				SELECT org.org_name,sc.scan_center_name,sm.*
				FROM	tb_scan_center sc
					INNER JOIN tb_organ org ON sc.org_id = org.org_id
					INNER JOIN (
						SELECT scan_center_code,gubun,count(seq) as check_cnt,count(weak_check) as weak_cnt, count(virus_check) as virus_cnt
						FROM	(
							SELECT v_asset_type as  gubun,vcs.scan_center_code,v_wvcs_seq as seq,
								(	SELECT TOP 1 v_wvcs_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_check,
								(	SELECT TOP 1 vcc.vaccine_seq 
									FROM tb_v_wvcs_vaccine vcc 
										INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
									WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
							FROM tb_v_wvcs_info vcs
								LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
							WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
								AND wvcs_dt between '".$params['sdate']."' and '".$params['edate']."'
								AND vcs.scan_center_code > '') T
						GROUP BY scan_center_code,gubun ) sm ON sc.scan_center_code = sm.scan_center_code
				ORDER BY sc.sort,sc.scan_center_name,sm.gubun
			";
			break;

		case 219 :
			$sql = "SELECT count(v_wvcs_seq) as vcs_cnt, count(weak) as weak_cnt, count(virus) as virus_cnt  
					FROM vw_user_vcs_result vcs1
						LEFT JOIN tb_scan_center cn
							ON vcs1.scan_center_code = cn.scan_center_code
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
						".$params['search_sql'];
			break;

		case 220 :
			$sql = "
				--tb_v_wvcs_info   
				SELECT 
					CASE WHEN v_asset_type ='NOTEBOOK' THEN 'NOTEBOOK' 
					ELSE 
						CASE WHEN device ='HDD' THEN 'HDD'
							WHEN device='Removable' THEN 'Removable'
							ELSE 'ETC' 
						END
					END as device_gubun,
					count(*) as vcs_cnt
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_v_wvcs_info_detail vcs2 on vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
					LEFT JOIN (select distinct media_type as device from tb_v_wvcs_pdisk UNION  SELECT 'CD/DVD') dv
						ON vcs1.v_asset_type='RemovableDevice' AND vcs2.os_ver_name like '%'+dv.device+'%'
					LEFT JOIN tb_scan_center cn ON vcs1.scan_center_code = cn.scan_center_code
				WHERE   ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					".$params['search_sql']." 
				GROUP BY CASE WHEN v_asset_type ='NOTEBOOK' THEN 'NOTEBOOK' 
					ELSE 
						CASE WHEN device ='HDD' THEN 'HDD'
							WHEN device='Removable' THEN 'Removable'
							ELSE 'ETC' 
						END
					END

				/*
				--pdisk,ldisk   
				SELECT device_gubun,count(*) as vcs_cnt
				FROM (
				SELECT distinct
					 
					CASE WHEN v_asset_type ='NOTEBOOK' THEN 'NOTEBOOK' 
					ELSE 
						CASE WHEN media_type ='HDD' THEN 'HDD'
							WHEN media_type='Removable' THEN 'Removable'
							ELSE 'ETC' 
						END
					END as device_gubun, vcs1.v_wvcs_seq
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_v_wvcs_info_detail vcs2 on vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
					LEFT JOIN (
						SELECT v_wvcs_seq,media_type
						FROM tb_v_wvcs_pdisk
						--UNION ALL
						--SELECT v_wvcs_seq, drive_type
						--FROM tb_v_wvcs_ldisk
						--WHERE drive_type ='CD/DVD'
					) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
					LEFT JOIN tb_scan_center cn ON vcs1.scan_center_code = cn.scan_center_code
				WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					".$params['search_sql']."  ) T
				GROUP BY device_gubun
				*/
			";
			break;
		
		case 221 :
			$sql = "
				SELECT 
					vcs1.v_wvcs_seq, vcs1.v_asset_type,convert(varchar(16),vcs1.wvcs_dt ,21) as	check_date,CONVERT(varchar(16),vcs1.wvcs_authorize_dt,21) as in_date,CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcs2.os_ver_name,vcs2.os_ver_major,vcs2.os_ver_minor) ELSE os_ver_name END as os_ver_name,wk.weakness_name,wk.org_status,wk.fix_status,vcs1.wvcs_type,usr.v_user_name,com.v_com_name
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_v_wvcs_info_detail vcs2 ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
					LEFT JOIN tb_scan_center cn ON vcs1.scan_center_code = cn.scan_center_code
					INNER JOIN tb_v_wvcs_weakness wk ON vcs1.v_wvcs_seq = wk.v_wvcs_seq
					INNER JOIN tb_v_user usr ON vcs1.v_user_seq = usr.v_user_seq
					LEFT JOIN	tb_v_company com ON usr.v_com_seq = com.v_com_seq
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					".$params['search_sql']." 
					AND wk.org_status='WEAK'
				ORDER BY vcs1.v_wvcs_seq DESC
			";
			break;

			
		case 222 :
			$sql = "
				SELECT 
					vcs1.v_wvcs_seq, vcs1.v_asset_type,convert(varchar(16),vcs1.wvcs_dt ,21) as	check_date,CONVERT(varchar(16),vcs1.wvcs_authorize_dt,21) as in_date,CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcs2.os_ver_name,vcs2.os_ver_major,vcs2.os_ver_minor) ELSE (SELECT TOP 1 drive_type FROM tb_v_wvcs_ldisk WHERE vcc1.v_wvcs_seq = v_wvcs_seq AND vcc2.vol_letter = vol_letter) END as os_ver_name,vcc1.vaccine_name,vcc1.scan_date,vcc1.vaccine_update_date,vcc2.virus_name,vcc2.virus_path,vcc2.virus_status,vcs1.wvcs_type,usr.v_user_name,com.v_com_name
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_v_wvcs_info_detail vcs2 ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
					LEFT JOIN tb_scan_center cn ON vcs1.scan_center_code = cn.scan_center_code
					INNER JOIN tb_v_wvcs_vaccine vcc1 ON vcs1.v_wvcs_seq = vcc1.v_wvcs_seq
					INNER JOIN tb_v_wvcs_vaccine_detail vcc2 ON vcc1.vaccine_seq = vcc2.vaccine_seq
					INNER JOIN tb_v_user usr ON vcs1.v_user_seq = usr.v_user_seq
					LEFT JOIN  tb_v_company com ON usr.v_com_seq = com.v_com_seq
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					".$params['search_sql']." 
				ORDER BY vcs1.v_wvcs_seq DESC
			";
			break;

		case 223 :
			$sql = "
				SELECT 'NOTEBOOK' as device_gubun, COUNT(DISTINCT vcs1.v_notebook_key) as device_cnt
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_scan_center cn ON vcs1.scan_center_code = cn.scan_center_code
				WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					AND vcs1.v_asset_type ='NOTEBOOK'
					".$params['search_sql']."
				UNION ALL
				SELECT 
					CASE WHEN media_type in ('HDD','Removable') THEN media_type ELSE 'ETC' END as device_gubun,
					COUNT(DISTINCT CASE WHEN media_type in ('HDD','Removable') THEN dsk.disk_model+dsk.serial_number ELSE CAST(disk_seq AS NVARCHAR) END) as device_cnt
					--COUNT(*) as device_cnt
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN (
						SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type
						FROM tb_v_wvcs_pdisk
						--UNION ALL
						--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type
						--FROM tb_v_wvcs_ldisk
						--WHERE drive_type ='CD/DVD'
					) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
					LEFT JOIN tb_scan_center cn ON vcs1.scan_center_code = cn.scan_center_code
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					AND vcs1.v_asset_type ='RemovableDevice'
					".$params['search_sql']."
				GROUP BY CASE WHEN media_type in ('HDD','Removable') THEN media_type ELSE 'ETC' END
			";
			break;
		case 224 :
			$sql = "
				SELECT COUNT(*) AS CNT 
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_v_wvcs_info_detail vcs2 
						ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
					LEFT JOIN (
							SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type
							FROM tb_v_wvcs_pdisk
							--UNION ALL
							--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type
							--FROM tb_v_wvcs_ldisk
							--WHERE drive_type ='CD/DVD'
						) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
					LEFT JOIN tb_scan_center cn
						ON vcs1.scan_center_code = cn.scan_center_code
					LEFT JOIN tb_organ org
						ON cn.org_id = org.org_id
					LEFT JOIN tb_v_user usr 
						ON vcs1.v_user_seq = usr.v_user_seq
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					".$params['search_sql']."
			";
			break;

		case 225 :
			$sql = " WITH VCS AS
				(
					SELECT top ".$params['end']."  usr.v_user_name,vcs1.v_wvcs_seq,vcs1.v_asset_type,CONVERT(varchar(16),vcs1.wvcs_authorize_dt,21) as in_date,CONVERT(varchar(16),vcs1.checkout_dt,21) as out_date,convert(varchar(16),wvcs_dt ,21) as		check_date,vcs1.wvcs_type,cn.scan_center_name,org.org_name,vcs2.v_sys_sn,vcs2.v_manufacturer,vcs2.v_model_name,dsk.manufacturer,dsk.serial_number,dsk.		disk_model,dsk.media_type,
						CASE WHEN vcs1.v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcs2.os_ver_name,vcs2.os_ver_major,vcs2.os_ver_minor) ELSE vcs2.os_ver_name END as os_ver_name,
						CASE WHEN vcs1.v_asset_type='NOTEBOOK' THEN 
							(SELECT count(pd_seq) FROM tb_v_wvcs_pdisk WHERE vcs1.v_wvcs_seq = v_wvcs_seq)
						ELSE 1 END as disk_cnt,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_v_wvcs_info vcs1
						LEFT JOIN tb_v_wvcs_info_detail vcs2 
							ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
						LEFT JOIN (
							SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type
							FROM tb_v_wvcs_pdisk
							--UNION ALL
							--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type
							--FROM tb_v_wvcs_ldisk
							--WHERE drive_type ='CD/DVD'
						) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
						LEFT JOIN tb_scan_center cn
							ON vcs1.scan_center_code = cn.scan_center_code
						LEFT JOIN tb_organ org
							ON cn.org_id = org.org_id
						LEFT JOIN tb_v_user usr 
							ON vcs1.v_user_seq = usr.v_user_seq
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
						".$params['search_sql']."
					) 
					SELECT * 
					FROM VCS 
					WHERE rnum > ".$params['start']." ";
			break;

		case 226 :
			$sql = "
				SELECT sum(weak_cnt) as weak_cnt, sum(vaccine_cnt) as virus_cnt
				FROM (
					SELECT 
						(	SELECT COUNT(*) FROM tb_v_wvcs_weakness WHERE vcs1.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_cnt,
						(	SELECT COUNT(*)
							FROM tb_v_wvcs_vaccine vcc 
								INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
							WHERE vcs1.v_wvcs_seq = v_wvcs_seq  ) as vaccine_cnt
					FROM tb_v_wvcs_info vcs1
						LEFT JOIN tb_scan_center cn ON vcs1.scan_center_code = cn.scan_center_code 
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
						".$params['search_sql']." 
					) T
			";
			break;

		case 227 :
			$sql = "
				SELECT	COUNT(*) as cnt
				FROM	tb_v_user
				WHERE	v_com_seq = '".$params['v_com_seq']." '
			";
			break;

		case 228 :
			$sql = "
				delete from tb_v_wvcs_ldisk where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_pdisk where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_macaddr where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_programs where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_vaccine_detail where vaccine_seq in (select vaccine_seq from tb_v_wvcs_vaccine where v_wvcs_seq = '".$params['v_wvcs_seq']."');
				delete from tb_v_wvcs_vaccine where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_weakness where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_windowsupdate_detail where windowsupdate_seq in (select windowsupdate_seq from tb_v_wvcs_windowsupdate where v_wvcs_seq = '".$params['v_wvcs_seq']."');
				delete from tb_v_wvcs_windowsupdate where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_info_detail where v_wvcs_seq = '".$params['v_wvcs_seq']."';
				delete from tb_v_wvcs_info where v_wvcs_seq = '".$params['v_wvcs_seq']."';

			";
			break;

		case 229 :
			$sql = " 
				SELECT usr.v_user_name,vcs1.v_wvcs_seq,vcs1.v_asset_type,CONVERT(varchar(16),vcs1.wvcs_authorize_dt,21) as in_date,CONVERT(varchar(16),vcs1.checkout_dt,21) as out_date, vcs1.vcs_status,convert(varchar(16),wvcs_dt ,21) as		check_date,vcs1.wvcs_type,cn.scan_center_name,org.org_name,vcs2.v_sys_sn,vcs2.v_manufacturer,vcs2.v_model_name,dsk.manufacturer,dsk.serial_number,dsk.		disk_model,dsk.media_type,
					CASE WHEN vcs1.v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcs2.os_ver_name,vcs2.os_ver_major,vcs2.os_ver_minor) ELSE vcs2.os_ver_name END as os_ver_name,
					CASE WHEN vcs1.v_asset_type='NOTEBOOK' THEN 
						(SELECT count(pd_seq) FROM tb_v_wvcs_pdisk WHERE vcs1.v_wvcs_seq = v_wvcs_seq)
					ELSE 1 END as disk_cnt
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_v_wvcs_info_detail vcs2 
						ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
					LEFT JOIN (
							SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type
							FROM tb_v_wvcs_pdisk
							--UNION ALL
							--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type
							--FROM tb_v_wvcs_ldisk
							--WHERE drive_type ='CD/DVD'
						) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
					LEFT JOIN tb_scan_center cn
						ON vcs1.scan_center_code = cn.scan_center_code
					LEFT JOIN tb_organ org
						ON cn.org_id = org.org_id
					LEFT JOIN tb_v_user usr 
						ON vcs1.v_user_seq = usr.v_user_seq
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					".$params['search_sql']
					 .$params['order_sql'];	
			break;

		
		case 230 :
			$sql = "
				SELECT	 vcs.v_wvcs_seq, vcs.barcode,convert(varchar(19),vcs.wvcs_dt ,21) as check_date,checkin_available_dt,vcd.v_sys_sn,vcd.v_hdd_sn,vcd.v_board_sn,mac_addr,vcs.memo_text,vc.v_com_name,v_notebook_key,
						wvcs_type,v_asset_type,os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,v_model_name,v_manufacturer,CONVERT(varchar(19), wvcs_authorize_dt,21) as  wvcs_authorize_dt, convert(varchar,vcs.checkout_dt,21) as checkout_dt,wvcs_authorize_name,cn.scan_center_name,cn.scan_center_code,vcs.ip_addr,org.org_name,
us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript
				FROM	tb_v_wvcs_info vcs
					LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
					INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
					LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					LEFT JOIN tb_organ org ON cn.org_id = org.org_id
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code').
					$params['search_sql']."
			";
			break;
		
		case 231 :
			$sql = "
				INSERT INTO tb_v_wvcs_scan_log(barcode,v_wvcs_seq,scan_result_msg,create_emp_seq,create_dt) VALUES(
					'".$params['barcode']."','".$params['v_wvcs_seq']."', N'".$params['scan_result_msg']."','".$params['create_emp_seq']."',getdate()
				);
			";
			break;

		case 232 :
			$sql = " 
				SELECT COUNT(*) AS CNT 
				FROM tb_v_wvcs_scan_log lg
					LEFT JOIN tb_employee em ON lg.create_emp_seq = em.emp_seq
					LEFT JOIN tb_v_wvcs_info vcs ON lg.v_wvcs_seq = vcs.v_wvcs_seq
					LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
					LEFT JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
					LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					LEFT JOIN tb_organ org ON cn.org_id = org.org_id
				WHERE (".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')." OR vcs.v_wvcs_seq IS NULL )
					".$params['search_sql']." ";
			break;

		case 233 :
			$sql = " WITH ScanLog AS
				(
					SELECT top ".$params['end']." 
						lg.scan_log_seq,lg.barcode,lg.v_wvcs_seq,lg.scan_result_msg,em.emp_name,em.emp_seq, convert(varchar(19),lg.create_dt,21) as create_dt, convert(varchar(16),wvcs_dt ,21) as	check_date,checkin_available_dt,v_manufacturer,wvcs_type,v_asset_type,v_notebook_key,v_sys_sn,
						CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcd.os_ver_name,vcd.os_ver_major,vcd.os_ver_minor) ELSE os_ver_name END as os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,CONVERT(varchar(16),vcs.wvcs_authorize_dt,21) as in_date, vc.v_com_name,cn.scan_center_name,org.org_name,
us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript,
						ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					FROM tb_v_wvcs_scan_log lg
						LEFT JOIN tb_employee em ON lg.create_emp_seq = em.emp_seq
						LEFT JOIN tb_v_wvcs_info vcs ON lg.v_wvcs_seq = vcs.v_wvcs_seq
						LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
						LEFT JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
						LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						LEFT JOIN tb_organ org ON cn.org_id = org.org_id
					WHERE (".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')." OR vcs.v_wvcs_seq IS NULL )
						".$params['search_sql']."
				) 
				SELECT * 
				FROM ScanLog 
				WHERE rnum > ".$params['start']." ";
			break;

		case 234 :
			$sql = " 
				SELECT 
					lg.scan_log_seq,lg.barcode,lg.v_wvcs_seq,lg.scan_result_msg,em.emp_name,em.emp_seq, convert(varchar(19),lg.create_dt,21) as create_dt, convert(varchar(16),wvcs_dt ,21) as	check_date,checkin_available_dt,v_manufacturer,wvcs_type,v_asset_type,v_notebook_key,v_sys_sn,
					CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcd.os_ver_name,vcd.os_ver_major,vcd.os_ver_minor) ELSE os_ver_name END as os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,CONVERT(varchar(16),vcs.wvcs_authorize_dt,21) as in_date, vc.v_com_name,cn.scan_center_name,org.org_name,
us.v_email,us.v_phone,dbo.fn_DecryptString(us.v_email) as v_email_decript, dbo.fn_DecryptString(us.v_phone) as v_phone_decript
				FROM tb_v_wvcs_scan_log lg
					LEFT JOIN tb_employee em ON lg.create_emp_seq = em.emp_seq
					LEFT JOIN tb_v_wvcs_info vcs ON lg.v_wvcs_seq = vcs.v_wvcs_seq
					LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
					LEFT JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
					LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
					LEFT JOIN tb_organ org ON cn.org_id = org.org_id
				WHERE (".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')." OR vcs.v_wvcs_seq IS NULL )
					".$params['search_sql']."
					".$params['order_sql']."
				";
			break;

		case 235 :
			$sql = " 
				SELECT lg.scan_log_seq,lg.barcode,lg.v_wvcs_seq,lg.scan_result_msg,convert(varchar(19),lg.create_dt,21) as create_dt
				FROM tb_v_wvcs_scan_log lg
					LEFT JOIN tb_v_wvcs_info vcs ON lg.v_wvcs_seq = vcs.v_wvcs_seq
					LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE (".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')." OR vcs.v_wvcs_seq IS NULL )
					".$params['search_sql']."
					".$params['order_sql'];
			break;
		
		case 236 :
			$sql = "
				SELECT COUNT(*) AS CNT
				FROM (
					SELECT	v_com_seq 
					FROM (
							SELECT	com.v_com_seq, com.v_com_name, vcs.v_wvcs_seq,
									(	SELECT TOP 1 weakness_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_check,
									(	SELECT TOP 1 vcc.vaccine_seq 
										FROM tb_v_wvcs_vaccine vcc 
											INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
										WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
							FROM tb_v_wvcs_info vcs
								INNER JOIN tb_v_user usr ON vcs.v_user_seq = usr.v_user_seq
								INNER JOIN tb_v_company com ON usr.v_com_seq = com.v_com_seq
								LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
							WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
								".$params['search_sql']." ) T1
					GROUP BY v_com_seq ) T2 ";
			break;
		
		case 237 :
			$sql = "
				WITH ComVcs AS
					(
						SELECT	top ".$params['end']." v_com_seq,max(v_com_name) as v_com_name,
								COUNT(v_wvcs_seq) as vcs_cnt,COUNT(weak_check) as weak_check_cnt, COUNT(virus_check) as virus_check_cnt,
								ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM (
								SELECT	com.v_com_seq, com.v_com_name, vcs.v_wvcs_seq,
										(	SELECT TOP 1 weakness_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_check,
										(	SELECT TOP 1 vcc.vaccine_seq 
											FROM tb_v_wvcs_vaccine vcc 
												INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
											WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
								FROM tb_v_wvcs_info vcs
									INNER JOIN tb_v_user usr ON vcs.v_user_seq = usr.v_user_seq
									INNER JOIN tb_v_company com ON usr.v_com_seq = com.v_com_seq
									LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
								WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
									".$params['search_sql']." ) T
						GROUP BY v_com_seq 
					)
					SELECT a.*
					FROM ComVcs  a
					WHERE rnum > ".$params['start'];
			break;

		case 238 :
			$sql = " 
				SELECT usr.v_user_name,vc.v_com_name,vcs1.v_wvcs_seq,vcs1.barcode,vcs1.checkin_available_dt,vcs1.v_asset_type,CONVERT(varchar(16),vcs1.wvcs_authorize_dt,21) as in_date,convert(varchar(16),wvcs_dt ,21) as		check_date,vcs1.wvcs_type,cn.scan_center_name,org.org_name,vcs2.v_sys_sn,vcs2.v_manufacturer,vcs2.v_model_name,dsk.manufacturer,dsk.serial_number,dsk.disk_model,dsk.media_type,dsk.tot_size,dsk.partition_cnt,
					CASE WHEN vcs1.v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcs2.os_ver_name,vcs2.os_ver_major,vcs2.os_ver_minor) ELSE vcs2.os_ver_name END as os_ver_name
				FROM tb_v_wvcs_info vcs1
					LEFT JOIN tb_v_wvcs_info_detail vcs2 
						ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
					LEFT JOIN (
							SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type,tot_size,partition_cnt
							FROM tb_v_wvcs_pdisk
							--UNION ALL
							--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type,tot_size,1
							--FROM tb_v_wvcs_ldisk
							--WHERE drive_type ='CD/DVD'
						) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
					LEFT JOIN tb_scan_center cn
						ON vcs1.scan_center_code = cn.scan_center_code
					LEFT JOIN tb_organ org
						ON cn.org_id = org.org_id
					LEFT JOIN tb_v_user usr 
						ON vcs1.v_user_seq = usr.v_user_seq
					LEFT JOIN tb_v_company vc 
						ON usr.v_com_seq = vc.v_com_seq
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
					".$params['search_sql']
					 .$params['order_sql'];	
			break;

		case 239 :
			$sql = "
				SELECT 
					base_date as label,
					COUNT(CASE WHEN convert(char(10),vcs.wvcs_dt,21)=base_date and notebook = 1  THEN 1 end) notebook_cnt,
					COUNT(CASE WHEN convert(char(10),vcs.wvcs_dt,21)=base_date and hdd = 1  THEN 1 end) hdd_cnt,
					COUNT(CASE WHEN convert(char(10),vcs.wvcs_dt,21)=base_date and removable = 1  THEN 1 end) removable_cnt,
					COUNT(CASE WHEN convert(char(10),vcs.wvcs_dt,21)=base_date and etc = 1  THEN 1 end) etc_cnt
				FROM (
					SELECT value as base_date 
					FROM dbo.fn_split( '".$params['str_date']."',',') ) dt  LEFT JOIN
					(
					SELECT 
						vcs1.wvcs_dt,
						CASE WHEN vcs1.v_asset_type = 'NOTEBOOK' THEN 1 END as notebook,
						CASE WHEN vcs1.v_asset_type = 'RemovableDevice' AND dsk.media_type ='HDD' THEN 1 END as hdd,
						CASE WHEN vcs1.v_asset_type = 'RemovableDevice' AND dsk.media_type ='Removable' THEN 1 END as removable,
						CASE WHEN vcs1.v_asset_type = 'RemovableDevice' AND CHARINDEX('HDD',dsk.media_type) = 0 AND CHARINDEX('Removable',dsk.media_type) = 0 THEN 1 END as etc
						FROM tb_v_wvcs_info vcs1
						LEFT JOIN tb_v_wvcs_info_detail vcs2 
							ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
						LEFT JOIN (
							SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type
							FROM tb_v_wvcs_pdisk
							--UNION ALL
							--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type
							--FROM tb_v_wvcs_ldisk
							--WHERE drive_type ='CD/DVD'
						) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
						LEFT JOIN tb_scan_center cn
							ON vcs1.scan_center_code = cn.scan_center_code
						WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')."
						AND wvcs_dt between '".$params['sdate']."' and '".$params['edate']."'  
						".$params['search_sql']." ) vcs ON dt.base_date = convert(char(10),vcs.wvcs_dt,21)
										
				GROUP BY base_date
				ORDER BY base_date
		
			";
			break;

		case 240 :
			$sql = "
				SELECT 
					base_month as label,
					COUNT(CASE WHEN convert(char(7),vcs.wvcs_dt,21)=base_month and notebook = 1  THEN 1 end) notebook_cnt,
					COUNT(CASE WHEN convert(char(7),vcs.wvcs_dt,21)=base_month and hdd = 1  THEN 1 end) hdd_cnt,
					COUNT(CASE WHEN convert(char(7),vcs.wvcs_dt,21)=base_month and removable = 1  THEN 1 end) removable_cnt,
					COUNT(CASE WHEN convert(char(7),vcs.wvcs_dt,21)=base_month and etc = 1  THEN 1 end) etc_cnt
				FROM (
					SELECT value as base_month 
					from fn_split('".$params['str_ym']."',',') ) dt LEFT JOIN
					(
					SELECT 
						vcs1.wvcs_dt,
						CASE WHEN vcs1.v_asset_type = 'NOTEBOOK' THEN 1 END as notebook,
						CASE WHEN vcs1.v_asset_type = 'RemovableDevice' AND dsk.media_type ='HDD' THEN 1 END as hdd,
						CASE WHEN vcs1.v_asset_type = 'RemovableDevice' AND dsk.media_type ='Removable' THEN 1 END as removable,
						CASE WHEN vcs1.v_asset_type = 'RemovableDevice' AND CHARINDEX('HDD',dsk.media_type) = 0 AND CHARINDEX('Removable',dsk.media_type) = 0 THEN 1 END as etc
						FROM tb_v_wvcs_info vcs1
						LEFT JOIN tb_v_wvcs_info_detail vcs2 
							ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
						LEFT JOIN (
							SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type
							FROM tb_v_wvcs_pdisk
							--UNION ALL
							--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type
							--FROM tb_v_wvcs_ldisk
							--WHERE drive_type ='CD/DVD'
						) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
						LEFT JOIN tb_scan_center cn
							ON vcs1.scan_center_code = cn.scan_center_code
						WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')."
						AND wvcs_dt between '".$params['sdate']."' and '".$params['edate']."'  
						".$params['search_sql']." ) vcs ON dt.base_month = convert(char(7),vcs.wvcs_dt,21)
										
				GROUP BY base_month
				ORDER BY base_month
			";
			break;

		case 241 :
			$sql = "
				SELECT	vcs.v_wvcs_seq, convert(varchar(16),wvcs_dt ,21) as	check_date,checkin_available_dt,v_manufacturer,
							wvcs_type,v_asset_type,v_notebook_key,v_sys_sn,CASE WHEN v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcd.os_ver_name,vcd.os_ver_major,vcd.os_ver_minor) ELSE
							os_ver_name END as os_ver_name,wvcs_success_yn,wvcs_authorize_yn,mngr_department,mngr_name,us.v_user_name,us.v_user_seq,
							CONVERT(varchar(16),vcs.wvcs_authorize_dt,21) as in_date, vc.v_com_name,cn.scan_center_name,org.org_name,vcs.vcs_status,CONVERT(varchar(16),vcs.checkout_dt,21) as checkout_dt,
							(	SELECT count(*) 
								FROM tb_v_wvcs_weakness 
								WHERE vcs.v_wvcs_seq = v_wvcs_seq
									AND org_status='WEAK') as weak_cnt,
							(	SELECT count(distinct vccd.virus_path) 
								FROM tb_v_wvcs_vaccine vcc
									INNER JOIN tb_v_wvcs_vaccine_detail  vccd
									ON  vcc.vaccine_seq = vccd.vaccine_seq
								WHERE vcs.v_wvcs_seq = v_wvcs_seq) as virus_cnt,
							(	(SELECT count(pd_seq) 
								FROM tb_v_wvcs_pdisk
								WHERE vcs.v_wvcs_seq = v_wvcs_seq)
								--+(SELECT count(ld_seq)
								--FROM tb_v_wvcs_ldisk
								--WHERE vcs.v_wvcs_seq = v_wvcs_seq
								--	AND drive_type='CD/DVD')
								) as disk_cnt
					FROM	tb_v_wvcs_info vcs
						LEFT JOIN tb_v_wvcs_info_detail vcd ON vcs.v_wvcs_seq = vcd.v_wvcs_seq
						INNER JOIN tb_v_user us ON vcs.v_user_seq = us.v_user_seq
						LEFT JOIN tb_v_company vc ON us.v_com_seq = vc.v_com_seq
						LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						LEFT JOIN tb_organ org ON cn.org_id = org.org_id
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						".$params['search_sql']
						 .$params['order_sql']."
				";			
			break;

		case 242 :
			$sql = "
				SELECT	v_com_seq,max(v_com_name) as v_com_name,
						COUNT(v_wvcs_seq) as vcs_cnt,COUNT(weak_check) as weak_check_cnt, COUNT(virus_check) as virus_check_cnt
				FROM (
						SELECT	com.v_com_seq, com.v_com_name, vcs.v_wvcs_seq,
								(	SELECT TOP 1 weakness_seq FROM tb_v_wvcs_weakness WHERE vcs.v_wvcs_seq = v_wvcs_seq AND org_status='WEAK') as weak_check,
								(	SELECT TOP 1 vcc.vaccine_seq 
									FROM tb_v_wvcs_vaccine vcc 
										INNER JOIN tb_v_wvcs_vaccine_detail vccd ON vcc.vaccine_seq = vccd.vaccine_seq 
									WHERE vcs.v_wvcs_seq = v_wvcs_seq  ) as virus_check
						FROM tb_v_wvcs_info vcs
							INNER JOIN tb_v_user usr ON vcs.v_user_seq = usr.v_user_seq
							INNER JOIN tb_v_company com ON usr.v_com_seq = com.v_com_seq
							LEFT JOIN tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
						WHERE  ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
							".$params['search_sql']." ) T
				GROUP BY v_com_seq 
				".$params['order_sql'];
			break;
		
		case 243 :
			$sql = "
				SELECT 
					usr.v_user_name,vcs1.v_wvcs_seq,vcs1.v_asset_type,CONVERT(varchar(16),vcs1.wvcs_authorize_dt,21) as in_date,convert(varchar(16),wvcs_dt ,21) as		check_date,vcs1.wvcs_type,cn.scan_center_name,org.org_name,vcs2.v_sys_sn,vcs2.v_manufacturer,vcs2.v_model_name,dsk.manufacturer,dsk.serial_number,dsk.disk_model,dsk.media_type,com.v_com_name,CONVERT(varchar(16),vcs1.checkout_dt,21) as checkout_dt,
						CASE WHEN vcs1.v_asset_type='NOTEBOOK' THEN dbo.fn_os_name(vcs2.os_ver_name,vcs2.os_ver_major,vcs2.os_ver_minor) ELSE vcs2.os_ver_name END as os_ver_name,
						CASE WHEN vcs1.v_asset_type='NOTEBOOK' THEN 
							(	SELECT count(pd_seq) 
								FROM tb_v_wvcs_pdisk
								WHERE vcs1.v_wvcs_seq = v_wvcs_seq)
						ELSE 1 END  as disk_cnt
					FROM tb_v_wvcs_info vcs1
						LEFT JOIN tb_v_wvcs_info_detail vcs2 
							ON vcs1.v_wvcs_seq = vcs2.v_wvcs_seq
						LEFT JOIN (
							SELECT pd_seq as disk_seq, v_wvcs_seq,manufacturer,serial_number,disk_model,media_type
							FROM tb_v_wvcs_pdisk
							--UNION ALL
							--SELECT ld_seq as disk_seq,v_wvcs_seq,'',vol_sn,vol_letter+'\'+vol_name,drive_type
							--FROM tb_v_wvcs_ldisk
							--WHERE drive_type ='CD/DVD'
						) dsk ON vcs1.v_asset_type='RemovableDevice' AND vcs1.v_wvcs_seq = dsk.v_wvcs_seq
						LEFT JOIN tb_scan_center cn
							ON vcs1.scan_center_code = cn.scan_center_code
						LEFT JOIN tb_organ org
							ON cn.org_id = org.org_id
						LEFT JOIN tb_v_user usr 
							ON vcs1.v_user_seq = usr.v_user_seq
						LEFT JOIN tb_v_company com 
							ON usr.v_com_seq = com.v_com_seq
					WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs1.scan_center_code')." 
						".$params['search_sql'].$params['order_sql']."
			";
			break;
		
		case 244 :
			$sql = "
				UPDATE tb_v_wvcs_info
				SET	
					 checkout_dt  = ".$params['checkout_dt']."
					 ,vcs_status = '".$params['vcs_status']."'
				WHERE v_wvcs_seq = '".$params['v_wvcs_seq']."'
			";
			break;

		case 245 :
			$sql = "
					INSERT INTO tb_admin_delete_log (emp_seq,emp_no,create_dt) Values ('".$params['emp_seq']."',(select emp_no from tb_employee where emp_seq ='".$params['emp_seq']."'),getdate())
				";
			break;

		
		case 246 :
			$sql = "
				select   v1.*, v2.v_com_name
				from tb_v_user v1 
					inner join tb_v_company v2 on v1.v_com_seq = v2.v_com_seq
					inner join tb_v_wvcs_info v3 on v1.v_user_seq = v3.v_user_seq
				where  v_wvcs_seq = '".$params['v_wvcs_seq']."'
			";
			break;

		case 247 :
			$sql = " 
				select count(*) as CNT
				from tb_v_wvcs_info vcs
					inner join tb_v_wvcs_info_detail v2
						on vcs.v_wvcs_seq = v2.v_wvcs_seq
					inner join tb_v_wvcs_info_file v3
						on v2.v_wvcs_detail_seq = v3.v_wvcs_detail_seq
					inner join tb_v_wvcs_info_file_in fin
						on v3.v_wvcs_file_seq = fin.v_wvcs_file_seq
					inner join tb_v_user vs 
						on vcs.v_user_seq = vs.v_user_seq
					left join tb_v_company vc
						on vs.v_com_seq = vc.v_com_seq
					left join tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
					".$params['search_sql'];
			break;

		case 248 :
			$sql = " WITH FileList AS
				(
					select top ".$params['end']." 
							vs.v_user_name, vc.v_com_name, v3.file_path,v3.file_size,v3.create_date,v3.file_name_org
							,ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
					from tb_v_wvcs_info vcs
						inner join tb_v_wvcs_info_detail v2
							on vcs.v_wvcs_seq = v2.v_wvcs_seq
						inner join tb_v_wvcs_info_file v3
							on v2.v_wvcs_detail_seq = v3.v_wvcs_detail_seq
						inner join tb_v_wvcs_info_file_in fin
							on v3.v_wvcs_file_seq = fin.v_wvcs_file_seq
						inner join tb_v_user vs 
							on vcs.v_user_seq = vs.v_user_seq
						left join tb_v_company vc
							on vs.v_com_seq = vc.v_com_seq
						left join tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
						".$params['search_sql']."
				) 
				SELECT * 
				FROM FileList 
				WHERE rnum > ".$params['start']." ";
			break;

		case 249 :
			$sql = " 
				select vs.v_user_name, vc.v_com_name, convert(varchar(16),vcs.wvcs_dt ,21) as	check_date, v3.file_path,v3.file_size,v3.create_date
					,v2.os_ver_name, v2.v_sys_sn
				from tb_v_wvcs_info vcs
					inner join tb_v_wvcs_info_detail v2
						on vcs.v_wvcs_seq = v2.v_wvcs_seq
					inner join tb_v_wvcs_info_file v3
						on v2.v_wvcs_detail_seq = v3.v_wvcs_detail_seq
					inner join tb_v_wvcs_info_file_in fin
							on v3.v_wvcs_file_seq = fin.v_wvcs_file_seq
					inner join tb_v_user vs 
						on vcs.v_user_seq = vs.v_user_seq
					left join tb_v_company vc
						on vs.v_com_seq = vc.v_com_seq
					left join tb_scan_center cn ON vcs.scan_center_code = cn.scan_center_code
				WHERE ".getCheckScanCenterAuthQuery('cn.org_id','vcs.scan_center_code')."
					".$params['search_sql'];
			break;












		
		case 10001 :
			$sql = "SELECT menu_code 
				FROM tb_admin_menu 
				WHERE emp_seq = '".$params['emp_seq']."' 
					and page_code is not null
					and ( isnull(admin_menu_auth_seq,0) =0 
						or admin_menu_auth_seq = (
							select top 1 admin_menu_auth_seq
							from tb_admin_menu_auth
							where  emp_seq = '".$params['emp_seq']."'
							order by admin_menu_auth_seq desc ) ) ";
			break;
		
		case 10002 :
			$sql = "
				SELECT	o.org_id,o.org_name,p.dept_seq,p.dept_name,p.lvl,p.hierarchy
				FROM	tb_organ o
					INNER JOIN vw_department p ON o.org_id = p.org_id
				WHERE ".getCheckOrgAuthQuery('o.org_id')."
					AND o.use_yn='Y'
					AND p.use_yn='Y'
				ORDER BY o.org_name,p.hierarchy ";
			break;
		
		case 10003 :
			$sql = " 
			 SELECT  *
			 FROM   tb_organ 
			 WHERE ".getCheckOrgAuthQuery('org_id')."
				AND use_yn='Y'
			 ORDER BY org_name ";
			break;

		case 10004 :
			$sql = " 
				select  *
				from   tb_jobgrade
				where  use_yn='Y'
				order by sort asc ";
			break;
		
		case 10005 :
			$sql = " 
				select  *
				from   tb_jobduty
				where  use_yn='Y'
				order by sort asc ";
			break;
		
		case 10006 :
			$sql = " 
				select  *
				from   tb_jobpos
				where  use_yn='Y'
				order by sort asc ";
			break;

		case 10007 :
			$sql = "SELECT * FROM tb_menu WHERE use_yn='Y' ORDER BY sort ";
			break;
		
		case 10008 :
			$sql = "SELECT emp_pwd FROM tb_employee WHERE emp_seq = '".$params['emp_seq']."' ";
			break;
		
		case 10009 :
			$sql = "SELECT org_name FROM tb_organ WHERE org_id='".$params['org_id']."' ";
			break;

		case 10010 :
			$sql = "SELECT * FROM tb_organ WHERE use_yn = 'Y' order by org_name ";
			break;

		case 10011 :
			$sql = "
				SELECT 
					code_seq,code_key,code_name
				FROM tb_code
				WHERE 
					code_key in ('".str_replace(",","','",$params['code_keys'])."')
					AND p_code_seq > 0
				ORDER BY code_key,sort ";
			break;

		case 10012:
			$sql = " SELECT ".$params['items']." FROM dbo.tb_employee WHERE work_yn='Y' ";
			break;

		case 10013 :
			$sql = " SELECT ".$params['items']." FROM dbo.tb_employee WHERE work_yn='Y' AND org_id = '".$params['org_id']."'";
			break;

		case 10014 :
			$sql = "
				SELECT	o.org_id,o.org_name,p.dept_seq,p.dept_name,p.lvl
				FROM	tb_organ o
					INNER JOIN vw_department p ON o.org_id = p.org_id
				WHERE o.use_yn='Y'
					AND p.use_yn='Y'
				ORDER BY o.org_name,p.hierarchy ";
			break;

		case 10015 :
			$sql = "SELECT @@identity as seq ;";
			break;

		case 10016 :
			$sql = "SELECT  ".$params['items']."  FROM tb_employee WHERE ".getCheckOrgAuthQuery('org_id')." AND work_yn='Y' ";

		case 10017 :
			$sql = "
				SELECT * 
				FROM tb_scan_center cn
					INNER JOIN tb_organ org ON cn.org_id = org.org_id
				WHERE cn.use_yn = 'Y' 
				ORDER BY cn.sort,scan_center_name ";
			break;

		case 10018 :
			$sql = "
				WITH VisitList AS(
				select 
				v2.v_user_list_seq,v1.v_user_name,v2.v_user_name_en, v_phone,v_email,v_company,v_purpose,manager_name,manager_name_en,manager_dept
				,v2.additional_cnt, v2.memo,v2.in_time,v2.in_center_code,c.scan_center_name as in_center_name
				,v3.pass_card_no
				,ROW_NUMBER() OVER( ".$params['order_sql']." ) as rnum
				from tb_v_user v1
				inner join tb_v_user_list v2 on v1.v_user_seq = v2.v_user_seq
				left join tb_v_user_list_info v3 on v2.v_user_list_seq = v3.v_user_list_seq
				left join tb_scan_center c on v2.in_center_code = c.scan_center_code
				where 1 = 1 ".$params['search_sql']."
				)
				SELECT a.*
				FROM VisitList a
				WHERE v_user_list_seq = '".$params['v_user_list_seq']."' ";
			break;

		case 10019 :
			$sql = "SELECT TOP 1 admin_menu_auth_seq, auth_type, auth_preset_seq
				FROM tb_admin_menu_auth
				WHERE  emp_seq = '".$params['emp_seq']."' 
				ORDER BY admin_menu_auth_seq DESC";
			break;

		case 10020 :
			$sql = "SELECT menu_code
				FROM tb_admin_menu_auth_preset_detail
				WHERE  preset_seq = '".$params['preset_seq']."' 
				ORDER BY detail_seq";
			break;

		case 10021 :
			$sql = "SELECT p2.menu_code
				FROM tb_admin_menu_auth_preset p1
					INNER JOIN tb_admin_menu_auth_preset_detail p2 ON p1.preset_seq = p2.preset_seq
				WHERE  p1.admin_level = '".$params['admin_level']."' 
				ORDER BY p2.detail_seq";
			break;

		case 10022 :
			$sql = "
				SELECT	cn.scan_center_code, cn.scan_center_name
				FROM	tb_admin_menu_auth_preset_scan_center sc
					INNER JOIN tb_scan_center cn ON sc.scan_center_code = cn.scan_center_code AND cn.use_yn = 'Y'
				WHERE	sc.preset_seq = '".$params['preset_seq']."'";
			break;

		case 250:
			$sql = "
					SELECT count(*) AS cnt
					FROM tb_login_ip_mgt a
					LEFT JOIN tb_employee b ON a.allow_id = b.emp_no
					LEFT JOIN tb_employee c ON a.admin_seq = c.emp_seq
					WHERE 1 = 1
							" . $params['search_sql'] . " ";
			break;

		case 251 :
			$sql = " 
		
				WITH IP AS
					(
						SELECT top ".$params['end']." a.login_ip_mgt_seq, a.ip_addr, a.allow_id, a.memo, convert(varchar(10),a.create_date,21) AS create_date, 
							b.emp_name AS allow_name, c.emp_name,
							ROW_NUMBER() OVER(".$params['order_sql'].") AS rnum
						FROM tb_login_ip_mgt a
							LEFT JOIN tb_employee b ON a.allow_id = b.emp_no
							LEFT JOIN tb_employee c ON a.admin_seq= c.emp_seq	
													
						WHERE 1 = 1
							".$params['search_sql']."
					) 
					SELECT a.*
					FROM IP  a	
					WHERE rnum > ".$params['start']." ";
			break;

		CASE 252 :
			$sql = " 
				WITH IP AS (
					SELECT a.login_ip_mgt_seq,a.ip_addr, a.allow_id, a.memo, convert(varchar(10),a.create_date,21) AS create_date, 
								b.emp_name AS allow_name, c.emp_name,ROW_NUMBER() OVER( ".$params['order_sql']."  ) AS rnum
					FROM tb_login_ip_mgt a
						LEFT JOIN tb_employee b ON a.allow_id = b.emp_no
						LEFT JOIN tb_employee c ON a.admin_seq= c.emp_seq
					WHERE 1 = 1
						".$params['search_sql']."
				) 
				SELECT *
				FROM	IP
				WHERE	login_ip_mgt_seq = '".$params['login_ip_mgt_seq']."' ";
			break;
		
		CASE 253 :
			$sql = " 
				WITH IP AS (
					SELECT a.login_ip_mgt_seq, a.ip_addr, a.allow_id, a.memo, convert(varchar(10),a.create_date,21) AS create_date, 
								b.emp_name AS allow_name, c.emp_name, ROW_NUMBER() OVER( ".$params['order_sql']."  ) AS rnum
					FROM tb_login_ip_mgt a
						LEFT JOIN tb_employee b ON a.allow_id = b.emp_no
						LEFT JOIN tb_employee c ON a.admin_seq= c.emp_seq
					WHERE 1 = 1
						".$params['search_sql']."
				) 
				SELECT TOP 1 *
				FROM IP 
				WHERE 1 = 1 ".$params['prev_next_sql'];
			break;

		CASE 254 :
			$sql = "INSERT INTO tb_login_ip_mgt (
						ip_addr,allow_id,memo,admin_seq,create_date
					)VALUES('".$params['ip_addr']."','".$params['allow_id']."','".$params['memo']."','".$params['admin_seq']."',getdate());";
			break;
	

		CASE 255 :
			$sql = "UPDATE tb_login_ip_mgt 
					SET ip_addr ='".$params['ip_addr']."',
					allow_id ='".$params['allow_id']."',
					memo =N'".$params['memo']."',
					admin_seq='".$params['admin_seq']."',
						create_date = getdate()
					WHERE login_ip_mgt_seq = '".$params['login_ip_mgt_seq']."' ";
			break;

		CASE 256 :
			$sql = "SELECT ip_addr,allow_id,memo FROM tb_login_ip_mgt WHERE login_ip_mgt_seq = '".$params['login_ip_mgt_seq']."' ";
			break;

		CASE 257 :
			$sql = "DELETE FROM tb_login_ip_mgt WHERE login_ip_mgt_seq = '".$params['login_ip_mgt_seq']."' ";
			break;

	
		CASE 258 :
			$sql = "SELECT SCOPE_IDENTITY() AS seq ;";
			break;
	


		CASE 259:
			$sql = "SELECT emp_name,emp_no,emp_seq
					FROM tb_employee
					WHERE work_yn='Y'
					ORDER BY emp_name ";
			break;

		CASE 260 :
			$sql = "
				INSERT INTO tb_admin_attempt_log(admin_seq,ip_addr,create_date,reset_yn) VALUES (
					'".$params['admin_seq']."','".$params['ip']."',getdate(),'N'
				)
			";
			break;
		CASE 261 :
			$sql = "
				UPDATE tb_admin_attempt_log
				SET reset_yn = 'Y'
				WHERE admin_seq = '".$params['admin_seq']."'
					AND CONVERT(varchar,create_date,112) like '".$params['today']."%'
			";
			break;
					CASE 262 :
			$sql = "
			SELECT count(*) as ADMIN_LOGIN_ATTEMPT_CNT
				FROM	tb_admin_attempt_log 
				WHERE	admin_seq = (SELECT TOP 1 emp_seq FROM tb_employee WHERE emp_no = '".$params['login_id']."') 
					AND CONVERT(varchar,create_date,112) like '".$params['today']."%'
					AND reset_yn='N' ";
			break;

			case 263 :
				$sql = " 
					SELECT COUNT(*) AS cnt 
					FROM tb_admin_attempt_log a
				  	LEFT JOIN tb_employee b ON a.admin_seq= b.emp_seq						
						WHERE 1 = 1
								" . $params['search_sql'] . " ";
				break;
	
			case 264 :
				$sql = " WITH PIP AS
					(
						SELECT top ".$params['end']." a.admin_attempt_log_seq,a.admin_seq, a.ip_addr,a.reset_yn, convert(varchar(19),create_date,21) as create_date,
						b.emp_name, b.emp_no,
							ROW_NUMBER() OVER(".$params['order_sql'].") as rnum
						FROM tb_admin_attempt_log a
							LEFT JOIN tb_employee b ON a.admin_seq= b.emp_seq	
					
						WHERE 1 = 1 
							".$params['search_sql']."
					) 
					SELECT a.* 
					FROM PIP a
					WHERE rnum > ".$params['start']." ";
				break;


		CASE 265 :
			$sql = "
				UPDATE tb_employee
				SET	LOGIN_LOCK_YN = '".$params['login_lock_yn']."'
					,LOGIN_LOCK_TYPE = '".$params['login_lock_type']."'
				WHERE emp_seq = '".$params['emp_seq']."' ".$params['search_sql'];
			break;
		CASE 266 :
			$sql = "SELECT emp_pwd, LOGIN_LOCK_YN FROM tb_employee WHERE emp_seq = '".$params['emp_seq']."' ";
			break;

						CASE 267:
				$sql = "
						SELECT count(*) AS cnt
						FROM tb_signature_id 
						WHERE 1 = 1
								" . $params['search_sql'] . " ";
				break;

			CASE 268 :
					$sql = " 				
						WITH IP AS
							(
								SELECT top ".$params['end']." sign_id_seq,file_id, str_name,use_yn, convert(varchar(12), create_date,21) AS create_date, 				
									ROW_NUMBER() OVER(".$params['order_sql'].") AS rnum
								FROM tb_signature_id 													
								WHERE 1 = 1
									".$params['search_sql']."
							) 
							SELECT *
							FROM IP  	
							WHERE rnum > ".$params['start']." ";
					break;
			CASE 269 :
					$sql = " 
						WITH IP AS (
							SELECT sign_id_seq,file_id, str_name,use_yn, convert(varchar(12), create_date,21) AS create_date, 
									ROW_NUMBER() OVER( ".$params['order_sql']."  ) AS rnum
							FROM tb_signature_id 							
							WHERE 1 = 1
								".$params['search_sql']."
						) 
						SELECT *
						FROM	IP
						WHERE	sign_id_seq = '".$params['sign_id_seq']."' ";
					break;

			CASE 270 :
					$sql = " 
						WITH IP AS (
							SELECT sign_id_seq,file_id, str_name,use_yn, convert(varchar(12),create_date,21) AS create_date, 
								 ROW_NUMBER() OVER( ".$params['order_sql']."  ) AS rnum
							FROM tb_signature_id 						
							WHERE 1 = 1
								".$params['search_sql']."
						) 
						SELECT TOP 1 *
						FROM IP 
						WHERE 1 = 1 ".$params['prev_next_sql'];
					break;
		
					CASE 271 :
					$sql = "INSERT INTO tb_signature_id (file_id, str_name,use_yn, create_date)VALUES('".$params['file_id']."','".$params['str_name']."','".$params['use_yn']."','".$params['create_date']."');";

					break;

		CASE 272 :
			$sql = "UPDATE tb_signature_id 
					SET file_id ='".$params['file_id']."',
					str_name ='".$params['str_name']."',
					use_yn ='".$params['use_yn']."',
						create_date = '".$params['create_date']."'
					WHERE sign_id_seq = '".$params['sign_id_seq']."' ";
			break;

		CASE 273 :
			$sql = "DELETE FROM tb_signature_id WHERE sign_id_seq = '".$params['sign_id_seq']."' ";
			break;


		CASE 274:
				$sql = "
						SELECT count(*) AS cnt
						FROM tb_signature_map 
						WHERE 1 = 1
								" . $params['search_sql'] . " ";
				break;

								CASE 275 :
					$sql = " 				
						WITH IP AS
							(
								SELECT top ".$params['end']." sign_map_seq,ext_name,file_id, str_name,search_flag,fake_check, convert(varchar(12), create_date,21) AS create_date, 				
									ROW_NUMBER() OVER(".$params['order_sql'].") AS rnum
								FROM tb_signature_map 													
								WHERE 1 = 1
									".$params['search_sql']."
							) 
							SELECT *
							FROM IP  	
							WHERE rnum > ".$params['start']." ";
					break;
						CASE 276 :
					$sql = " 
						WITH IP AS (
							SELECT sign_map_seq,ext_name,file_id, str_name,search_flag,fake_check, convert(varchar(12), create_date,21) AS create_date, 
									ROW_NUMBER() OVER( ".$params['order_sql']."  ) AS rnum
							FROM tb_signature_map 							
							WHERE 1 = 1
								".$params['search_sql']."
						) 
						SELECT *
						FROM	IP
						WHERE	sign_map_seq = '".$params['sign_map_seq']."' ";
					break;

							CASE 277 :
					$sql = " 
						WITH IP AS (
							SELECT sign_map_seq,ext_name,file_id, str_name,search_flag,fake_check, convert(varchar(12),create_date,21) AS create_date, 
								 ROW_NUMBER() OVER( ".$params['order_sql']."  ) AS rnum
							FROM tb_signature_map 						
							WHERE 1 = 1
								".$params['search_sql']."
						) 
						SELECT TOP 1 *
						FROM IP 
						WHERE 1 = 1 ".$params['prev_next_sql'];
					break;
		
			CASE 278 :
					$sql = "INSERT INTO tb_signature_map (
								ext_name,file_id, str_name,search_flag,create_date,fake_check
							)VALUES('".$params['ext_name']."','".$params['file_id']."','".$params['str_name']."','".$params['search_flag']."','".$params['create_date']."','".$params['fake_check']."');";
					break;

								CASE 279 :
			$sql = "UPDATE tb_signature_map 
					SET ext_name ='".$params['ext_name']."',
					file_id ='".$params['file_id']."',
					str_name ='".$params['str_name']."',
					search_flag ='".$params['search_flag']."',
						create_date = '".$params['create_date']."',
						fake_check ='".$params['fake_check']."'
					WHERE sign_map_seq = '".$params['sign_map_seq']."' ";
			break;

		CASE 280 :
			$sql = "DELETE FROM tb_signature_map WHERE sign_map_seq = '".$params['sign_map_seq']."' ";
			break;
			
		case 281 :
			$sql = "SELECT sign_map_seq,ext_name,file_id, str_name,search_flag,fake_check, convert(varchar(12),create_date,21) AS create_date, 
								 ROW_NUMBER() OVER( ".$params['order_sql']."  ) AS rnum
							FROM tb_signature_map 						
							WHERE 1 = 1
								".$params['search_sql']."
				";
			break;

		CASE 282:
			$sql = $params['search_sql'];
			break;

			

		

		

		

		

	
		


	}//switch($label){
	


	if($_query_logging){
		
		$Dir = "/".$_site_path."/log/";
		$FileName = "log".date("Ym").".txt";
		
		$logFile = @fopen($_SERVER['DOCUMENT_ROOT'].$Dir.$FileName, "a+") or die("Unable to open file!");
		fwrite($logFile, "/*query_label:".$label."*/\r\n".trim($sql)."\r\n\r\n");
		fclose($logFile);
		
	}

	#  
	WriteAdminActDetailLog($work_log_seq,$sql,$params);

	return $sql;



}
?>